<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "8abd335151cee553293b637ee3d80d10",
  "translation_date": "2025-11-11T12:18:27+00:00",
  "source_file": "08-multi-agent/code_samples/workflows-agent-framework/dotNET/04.dotnet-agent-framework-workflow-aifoundry-condition.md",
  "language_code": "sv"
}
-->
# ğŸ”€ Villkorliga agentarbetsflÃ¶den med Azure AI Foundry (.NET)

## ğŸ“‹ Handledning fÃ¶r intelligenta beslutbaserade arbetsflÃ¶den

Den hÃ¤r notebooken demonstrerar **villkorliga arbetsflÃ¶desmÃ¶nster** med Azure AI Foundry och Microsoft Agent Framework fÃ¶r .NET. Du kommer att lÃ¤ra dig att bygga avancerade, beslutsdrivna arbetsflÃ¶den som intelligent styr bearbetning baserat pÃ¥ AI-analys, affÃ¤rsregler och dynamiska villkor fÃ¶r automatisering pÃ¥ fÃ¶retagsnivÃ¥.

## ğŸ¯ InlÃ¤rningsmÃ¥l

### ğŸ§  **Intelligent beslutsarkitektur**
- **Implementering av villkorlig logik**: Bygg komplexa beslutstrÃ¤d med flera fÃ¶rgreningspunkter
- **AI-driven styrning**: AnvÃ¤nd Azure AI Foundry-modeller fÃ¶r att fatta intelligenta styrningsbeslut
- **Dynamisk anpassning av arbetsflÃ¶den**: Ã„ndra arbetsflÃ¶desbeteende baserat pÃ¥ analys och villkor vid kÃ¶rning
- **Integration av fÃ¶retagsregler**: Inkludera affÃ¤rslogik och efterlevnadskrav i arbetsflÃ¶den

### ğŸ”€ **Avancerade villkorsmÃ¶nster**
- **Beslutsfattande med flera kriterier**: UtvÃ¤rdera flera faktorer fÃ¶r styrningsbeslut
- **Kontextmedveten bearbetning**: Fatta beslut baserat pÃ¥ ackumulerad arbetsflÃ¶deskontext och historik
- **Anpassning av arbetsflÃ¶den**: Dynamiskt justera bearbetningsvÃ¤gar baserat pÃ¥ realtidsvillkor
- **Integration av regelmotor**: Implementera avancerade affÃ¤rsregelmotorer inom arbetsflÃ¶den

### ğŸ¢ **Villkorliga applikationer fÃ¶r fÃ¶retag**
- **Dokumentklassificering och styrning**: Klassificera och styr dokument automatiskt till lÃ¤mpliga arbetsflÃ¶den
- **KundtjÃ¤nsttriage**: Intelligent styrning av kundfÃ¶rfrÃ¥gningar till specialiserade hanteringsteam
- **Efterlevnad och riskbearbetning**: TillÃ¤mpa olika validerings- och granskningsprocesser baserat pÃ¥ riskbedÃ¶mning
- **KvalitetssÃ¤kringsarbetsflÃ¶den**: Styr innehÃ¥ll genom lÃ¤mpliga granskningsprocesser baserat pÃ¥ kvalitetsmÃ¥tt

## âš™ï¸ FÃ¶rutsÃ¤ttningar och installation

### ğŸ“¦ **NÃ¶dvÃ¤ndiga NuGet-paket**

Avancerade paket fÃ¶r villkorlig arbetsflÃ¶desbearbetning:

```xml
<!-- Core AI Framework -->
<PackageReference Include="Microsoft.Extensions.AI" Version="9.9.0" />

<!-- Azure AI Agents with Persistent State -->
<PackageReference Include="Azure.AI.Agents.Persistent" Version="1.2.0-beta.5" />

<!-- Azure Identity and Utilities -->
<PackageReference Include="Azure.Identity" Version="1.15.0" />
<PackageReference Include="System.Linq.Async" Version="6.0.3" />
<PackageReference Include="DotNetEnv" Version="3.1.1" />

<!-- Local Workflow Framework References -->
<!-- Microsoft.Agents.Workflows.dll - Advanced workflow orchestration -->
<!-- Microsoft.Agents.AI.AzureAI.dll - Azure AI Foundry integration -->
<!-- Microsoft.Agents.AI.dll - Core agent abstractions -->
```

### ğŸ”‘ **Konfiguration av Azure AI Foundry**

**NÃ¶dvÃ¤ndiga Azure-resurser:**
- Azure AI Foundry-arbetsyta med modeller fÃ¶r villkorlig bearbetning
- Azure-abonnemang med lÃ¤mpliga berÃ¤kningskvoter och behÃ¶righeter
- Implementerade AI-modeller fÃ¶r beslutsfattande och innehÃ¥llsanalys
- (Valfritt) Bing Search API-anslutning fÃ¶r grundlÃ¤ggande funktioner

**MiljÃ¶konfiguration (.env-fil):**
```env
# Azure AI Foundry Configuration
AZURE_AI_PROJECT_ENDPOINT=https://your-project.cognitiveservices.azure.com/
BING_CONNECTION_ID=your-bing-connection-id
```

**AutentiseringsinstÃ¤llningar:**
```csharp
// Azure CLI or Managed Identity authentication
using Azure.Identity;
var credential = new AzureCliCredential();

// Load environment configuration
DotNetEnv.Env.Load("../../../.env");
```

### ğŸ—ï¸ **Arkitektur fÃ¶r villkorliga arbetsflÃ¶den**

```mermaid
graph TD
    A[Input: Content Outline] --> B[Draft Executor]
    B --> C[Content Review Executor]
    C --> D{Review Decision}
    
    D -->|Yes - Approved| E[Publish Executor]
    D -->|No - Rejected| F[Send Review Executor]
    
    E --> G[Save as Markdown File]
    F --> H[Notify for Revisions]
    
    I[Azure AI Foundry] --> B
    I --> C
    I --> E
    
    J[Bing Grounding] --> B
```

**Nyckelkomponenter:**
- **Draft Executor**: AI-agent som skapar initiala innehÃ¥llsutkast frÃ¥n konturer
- **Content Review Executor**: AI-agent som utvÃ¤rderar utkastets kvalitet och efterlevnad
- **Villkorlig styrning**: Beslutslogik som styr baserat pÃ¥ granskningsresultat
- **Publicerings-/granskningsvÃ¤gar**: Separata bearbetningsvÃ¤gar fÃ¶r godkÃ¤nt respektive avvisat innehÃ¥ll
- **TillstÃ¥ndshantering**: BibehÃ¥ller innehÃ¥ll och granskningskontext genom hela arbetsflÃ¶det

## ğŸ¨ **DesignmÃ¶nster fÃ¶r villkorliga arbetsflÃ¶den**

### ğŸ“‹ **InnehÃ¥llsproduktion med kvalitetskontroller**
```
Outline â†’ Draft Creation â†’ Quality Review â†’ {Approve: Publish | Reject: Revise}
```

### ğŸ¯ **Riskbaserad dokumentbearbetning**
```
Document â†’ Risk Assessment â†’ {Low: Standard | High: Enhanced Review}
```

### ğŸ” **Intelligent styrning av kundtjÃ¤nst**
```
Customer Query â†’ Analysis â†’ {Simple: FAQ Bot | Complex: Human Agent}
```

### ğŸ’¼ **Efterlevnadsdrivna arbetsflÃ¶den**
```
Content â†’ Compliance Check â†’ {Pass: Publish | Fail: Legal Review}
```

## ğŸ¢ **FÃ¶rdelar med villkorliga arbetsflÃ¶den fÃ¶r fÃ¶retag**

### ğŸ¯ **Intelligent automatisering**
- **Smarta beslut**: AI-driven styrning baserad pÃ¥ innehÃ¥llsanalys och kontext
- **Anpassad bearbetning**: ArbetsflÃ¶den som automatiskt justeras baserat pÃ¥ fÃ¶rÃ¤ndrade villkor
- **Efterlevnad av affÃ¤rsregler**: Automatisk tillÃ¤mpning av komplex affÃ¤rslogik och policyer
- **Kontextmedveten styrning**: Beslut baserade pÃ¥ fullstÃ¤ndig arbetsflÃ¶deshistorik och ackumulerad kontext

### ğŸ“ˆ **Operativ excellens**
- **Optimerad resursallokering**: Styr arbete till de mest lÃ¤mpliga specialisterna och processerna
- **Minskad manuell intervention**: Automatiskt beslutsfattande minimerar behovet av mÃ¤nsklig styrning
- **Snabbare lÃ¶sningstider**: Direkt styrning till lÃ¤mplig expertis och bearbetningskapacitet
- **Konsekvent tillÃ¤mpning**: Enhetlig tillÃ¤mpning av affÃ¤rsregler och beslutsgrunder

### ğŸ›¡ï¸ **Riskhantering och efterlevnad**
- **Automatisk riskbedÃ¶mning**: AI-driven utvÃ¤rdering av innehÃ¥ll och risknivÃ¥er
- **EfterlevnadssÃ¤kring**: Automatisk styrning genom nÃ¶dvÃ¤ndiga regulatoriska processer
- **TillÃ¤mpning av sÃ¤kerhetsprotokoll**: FÃ¶rbÃ¤ttrade sÃ¤kerhetsÃ¥tgÃ¤rder baserade pÃ¥ riskbedÃ¶mning
- **UnderhÃ¥ll av granskningsspÃ¥r**: Komplett dokumentation av styrningsbeslut och motiveringar

### ğŸ“Š **Analys och kontinuerlig fÃ¶rbÃ¤ttring**
- **Beslutsanalys**: SpÃ¥ra effektiviteten och noggrannheten i styrningsbeslut
- **MÃ¶nsterigenkÃ¤nning**: Identifiera trender och mÃ¶nster i styrningsbeslut Ã¶ver tid
- **Prestandaoptimering**: Kontinuerlig fÃ¶rbÃ¤ttring av beslutsgrunder och styrningseffektivitet
- **AffÃ¤rsintelligens**: Insikter i innehÃ¥llskarakteristik och bearbetningskrav

### ğŸ”§ **Teknisk excellens**
- **Persistent tillstÃ¥ndshantering**: BibehÃ¥ll komplexa tillstÃ¥nd genom arbetsflÃ¶desutfÃ¶rande
- **Skalbar arkitektur**: Hantera hÃ¶gvolymbearbetning med villkorlig styrning
- **IntegrationsmÃ¶jligheter**: SÃ¶mlÃ¶s integration med befintliga affÃ¤rssystem och processer
- **Ã–vervakning och observabilitet**: Omfattande spÃ¥rning av arbetsflÃ¶dets prestanda och beslut

LÃ¥t oss bygga intelligenta, beslutsdrivna arbetsflÃ¶den fÃ¶r fÃ¶retag med .NET! ğŸš€

## ğŸ’» KÃ¶ra koden

Den kompletta implementeringen finns i `04.dotnet-agent-framework-workflow-aifoundry-condition.cs`. Den demonstrerar ett **arbetsflÃ¶de fÃ¶r innehÃ¥llsproduktion med kvalitetskontroller**:

### ğŸ—ï¸ **ArbetsflÃ¶desarkitektur**

```
Content Outline â†’ Draft Creation â†’ Quality Review â†’ Conditional Routing:
                                                      â”œâ”€ Approved (>200 words) â†’ Publish
                                                      â””â”€ Rejected (<200 words) â†’ Review Notification
```

**Agenter i arbetsflÃ¶det:**
1. **Evangelist Agent**: Skapar utkast till handledningar frÃ¥n konturer med Bing-grundning
2. **Content Reviewer Agent**: UtvÃ¤rderar utkastets kvalitet (ordantal, fullstÃ¤ndighet)
3. **Publisher Agent**: Sparar godkÃ¤nt innehÃ¥ll som tidsstÃ¤mplade Markdown-filer

**Anpassade exekutorer:**
1. **DraftExecutor**: Orkestrerar skapandet av utkast
2. **ContentReviewExecutor**: UtfÃ¶r kvalitetsbedÃ¶mning
3. **PublishExecutor**: Hanterar publicering av godkÃ¤nt innehÃ¥ll
4. **SendReviewExecutor**: Hanterar aviseringar om avvisat innehÃ¥ll

### ğŸš€ KÃ¶ra exemplet

**FÃ¶rutsÃ¤ttningar:**
- Konfigurerad Azure AI Foundry-arbetsyta
- Azure CLI-autentisering (`az login`)
- (Valfritt) Bing Search-anslutning fÃ¶r grundning

```bash
# Make the script executable (Unix/Linux/macOS)
chmod +x 04.dotnet-agent-framework-workflow-aifoundry-condition.cs

# Run the conditional workflow
./04.dotnet-agent-framework-workflow-aifoundry-condition.cs
```

Eller pÃ¥ Windows:
```powershell
dotnet run 04.dotnet-agent-framework-workflow-aifoundry-condition.cs
```

### ğŸ“ FÃ¶rvÃ¤ntat resultat

ArbetsflÃ¶det kommer att:
1. **Skapa agenter**: Initiera tre specialiserade Azure AI Foundry-agenter
2. **Generera utkast**: Evangelist-agenten skapar handledningsutkast frÃ¥n konturer
3. **Granska innehÃ¥ll**: Content Reviewer utvÃ¤rderar utkastets kvalitet
4. **Villkorlig styrning**:
   - **Om godkÃ¤nt (>200 ord)**: Publish Executor sparar som Markdown-fil
   - **Om avvisat (<200 ord)**: Skicka granskningsavisering
5. **Visa resultat**: Visa slutligt arbetsflÃ¶desresultat

### ğŸ”§ Anpassningsalternativ

**Ã„ndra granskningskriterier:**
```csharp
const string ContentReviewerInstructions = @"
You are a content reviewer...
1. Check if content is more than 500 words (instead of 200)
2. Verify technical accuracy
3. Ensure proper formatting
...";
```

**LÃ¤gg till fler villkorliga vÃ¤gar:**
```csharp
var workflow = new WorkflowBuilder(draftExecutor)
    .AddEdge(draftExecutor, contentReviewerExecutor)
    .AddEdge(contentReviewerExecutor, publishExecutor, condition: GetCondition("Excellent"))
    .AddEdge(contentReviewerExecutor, editExecutor, condition: GetCondition("Good"))
    .AddEdge(contentReviewerExecutor, sendReviewerExecutor, condition: GetCondition("Poor"))
    .Build();
```

**Ã„ndra innehÃ¥llskrav:**
```csharp
string OUTLINE_Content = @"
# Your Custom Topic
## Section 1
https://your-reference-url
## Section 2
...
";
```

### ğŸ¯ Verkliga applikationer

Detta villkorliga arbetsflÃ¶desmÃ¶nster Ã¤r idealiskt fÃ¶r:
- **InnehÃ¥llshanteringssystem**: Automatiserade redaktionella arbetsflÃ¶den med kvalitetskontroller
- **Dokumentbearbetning**: Styr dokument baserat pÃ¥ klassificering och efterlevnad
- **Kundsupport**: Intelligent biljettstyrning baserat pÃ¥ komplexitet och brÃ¥dska
- **Juridisk granskning**: Styr kontrakt baserat pÃ¥ riskbedÃ¶mning och vÃ¤rde
- **HR-processer**: Styr ansÃ¶kningar genom lÃ¤mpliga granskningsarbetsflÃ¶den

### ğŸ” FÃ¶rstÃ¥ villkorlig logik

**Villkorsfunktion:**
```csharp
public Func<object?, bool> GetCondition(string expectedResult) =>
    reviewResult => reviewResult is ReviewResult review && review.Result == expectedResult;
```

Denna funktion skapar en predikat som:
1. Kontrollerar om resultatet Ã¤r av typen `ReviewResult`
2. JÃ¤mfÃ¶r egenskapen `Result` med det fÃ¶rvÃ¤ntade vÃ¤rdet
3. Returnerar sant/falskt fÃ¶r att avgÃ¶ra styrning

**ArbetsflÃ¶deskanter med villkor:**
```csharp
.AddEdge(contentReviewerExecutor, publishExecutor, condition: GetCondition("Yes"))
.AddEdge(contentReviewerExecutor, sendReviewerExecutor, condition: GetCondition("No"))
```

### ğŸ“Š Avancerade funktioner

**JSON-schema validering:**
ArbetsflÃ¶det anvÃ¤nder JSON-scheman fÃ¶r att sÃ¤kerstÃ¤lla strukturerade svar:

```csharp
// Define response structure
public class ReviewResult
{
    [JsonPropertyName("review_result")]
    public string Result { get; set; } = string.Empty;
    
    [JsonPropertyName("reason")]
    public string Reason { get; set; } = string.Empty;
    
    [JsonPropertyName("draft_content")]
    public string DraftContent { get; set; } = string.Empty;
}

// Apply to agent
ResponseFormat = ChatResponseFormat.ForJsonSchema(
    AIJsonUtilities.CreateJsonSchema(typeof(ReviewResult)), 
    "ReviewResult", 
    "Review Result From DraftContent"
)
```

**Bing-grundningsintegration:**
Evangelist-agenten anvÃ¤nder Bing-grundning fÃ¶r att fÃ¥ tillgÃ¥ng till realtidsinformation:

```csharp
var bingGroundingConfig = new BingGroundingSearchConfiguration(bing_conn_id);
BingGroundingToolDefinition bingGroundingTool = new(
    new BingGroundingSearchToolParameters([bingGroundingConfig])
);
```

Detta gÃ¶r det mÃ¶jligt fÃ¶r agenten att fÃ¶lja URL:er i konturen och extrahera aktuell information.

### ğŸ›¡ï¸ Felhantering

ArbetsflÃ¶det inkluderar robust felhantering fÃ¶r avvisat innehÃ¥ll:
- Granskningsfel utlÃ¶ser den alternativa vÃ¤gen
- Aviseringar ger tydliga avvisningsskÃ¤l
- InnehÃ¥ll bevaras fÃ¶r revidering

### ğŸ”„ UtÃ¶ka arbetsflÃ¶det

**LÃ¤gg till en revideringsloop:**
Skapa en feedbackloop som automatiskt skapar om innehÃ¥ll:

```csharp
.AddEdge(contentReviewerExecutor, publishExecutor, condition: GetCondition("Yes"))
.AddEdge(contentReviewerExecutor, draftExecutor, condition: GetCondition("No")) // Loop back
```

**Implementera fler nivÃ¥er av granskning:**
LÃ¤gg till flera granskningssteg med olika kriterier:

```csharp
.AddEdge(draftExecutor, technicalReviewer)
.AddEdge(technicalReviewer, editorialReviewer, condition: GetCondition("TechPass"))
.AddEdge(editorialReviewer, publishExecutor, condition: GetCondition("EditPass"))
```

Detta villkorliga arbetsflÃ¶desmÃ¶nster ger grunden fÃ¶r att bygga avancerade, intelligenta automatiseringssystem fÃ¶r fÃ¶retag! ğŸš€

---

<!-- CO-OP TRANSLATOR DISCLAIMER START -->
**Ansvarsfriskrivning**:  
Detta dokument har Ã¶versatts med hjÃ¤lp av AI-Ã¶versÃ¤ttningstjÃ¤nsten [Co-op Translator](https://github.com/Azure/co-op-translator). Ã„ven om vi strÃ¤var efter noggrannhet, bÃ¶r det noteras att automatiserade Ã¶versÃ¤ttningar kan innehÃ¥lla fel eller felaktigheter. Det ursprungliga dokumentet pÃ¥ dess ursprungliga sprÃ¥k bÃ¶r betraktas som den auktoritativa kÃ¤llan. FÃ¶r kritisk information rekommenderas professionell mÃ¤nsklig Ã¶versÃ¤ttning. Vi ansvarar inte fÃ¶r eventuella missfÃ¶rstÃ¥nd eller feltolkningar som uppstÃ¥r vid anvÃ¤ndning av denna Ã¶versÃ¤ttning.
<!-- CO-OP TRANSLATOR DISCLAIMER END -->