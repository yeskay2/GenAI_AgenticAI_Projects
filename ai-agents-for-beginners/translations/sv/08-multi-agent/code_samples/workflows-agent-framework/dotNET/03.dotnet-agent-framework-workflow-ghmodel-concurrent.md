<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "b9c6e32c9b5f2fed20b6916984440d88",
  "translation_date": "2025-11-11T13:21:04+00:00",
  "source_file": "08-multi-agent/code_samples/workflows-agent-framework/dotNET/03.dotnet-agent-framework-workflow-ghmodel-concurrent.md",
  "language_code": "sv"
}
-->
# âš¡ Samtidiga AgentarbetsflÃ¶den med GitHub-modeller (.NET)

## ğŸ“‹ Handledning fÃ¶r hÃ¶gpresterande parallell bearbetning

Den hÃ¤r guiden visar **samtidiga arbetsflÃ¶desmÃ¶nster** med Microsoft Agent Framework fÃ¶r .NET och GitHub-modeller. Du kommer att lÃ¤ra dig att bygga hÃ¶gpresterande, parallella arbetsflÃ¶den som maximerar genomstrÃ¶mningen genom att kÃ¶ra flera AI-agenter samtidigt, samtidigt som du upprÃ¤tthÃ¥ller samordning och datakonsistens.

## ğŸ¯ LÃ¤randemÃ¥l

### ğŸš€ **Grunderna i samtidiga processer**
- **Parallell agentkÃ¶rning**: KÃ¶r flera AI-agenter samtidigt fÃ¶r maximal prestanda
- **Async/Await-mÃ¶nster**: Utnyttja .NET:s asynkrona programmeringsmodell fÃ¶r effektiv samtidighet
- **Integration med GitHub-modeller**: Samordna flera samtidiga anrop till GitHubs AI-modelltjÃ¤nst
- **Resurshantering**: Hantera AI-modellresurser effektivt Ã¶ver samtidiga operationer

### ğŸ—ï¸ **Avancerad arkitektur fÃ¶r samtidighet**
- **Uppgiftsbaserad parallellism**: AnvÃ¤nd .NET:s Task Parallel Library fÃ¶r optimal samtidighet
- **SynkroniseringsmÃ¶nster**: Samordna samtidiga agenter och undvik race conditions
- **Lastbalansering**: FÃ¶rdela arbete effektivt Ã¶ver tillgÃ¤nglig bearbetningskapacitet
- **Feltolerans**: Hantera enskilda agentfel utan att stoppa hela arbetsflÃ¶det

### ğŸ¢ **Samtidiga applikationer fÃ¶r fÃ¶retag**
- **HÃ¶gvolym dokumentbearbetning**: Bearbeta flera dokument samtidigt
- **RealtidsinnehÃ¥llsanalys**: Samtidig analys av inkommande datastreams
- **Optimering av batchbearbetning**: Maximera genomstrÃ¶mningen fÃ¶r storskaliga databehandlingsoperationer
- **Multimodal analys**: Parallell bearbetning av olika innehÃ¥llstyper och format

## âš™ï¸ FÃ¶rutsÃ¤ttningar och installation

### ğŸ“¦ **NÃ¶dvÃ¤ndiga NuGet-paket**

Viktiga paket fÃ¶r hÃ¶gpresterande samtidiga arbetsflÃ¶den:

```xml
<!-- Core AI Framework with Async Support -->
<PackageReference Include="Microsoft.Extensions.AI" Version="9.9.0" />

<!-- Client Model Abstractions for API Communication -->
<PackageReference Include="System.ClientModel" Version="1.6.1.0" />

<!-- Azure Identity and Async LINQ for Advanced Operations -->
<PackageReference Include="Azure.Identity" Version="1.15.0" />
<PackageReference Include="System.Linq.Async" Version="6.0.3" />

<!-- Local Agent Framework References -->
<!-- Microsoft.Agents.AI.dll - Core agent abstractions with async support -->
<!-- Microsoft.Agents.AI.OpenAI.dll - GitHub Models integration with concurrency -->
```

### ğŸ”‘ **Konfiguration av GitHub-modeller**

**MiljÃ¶instÃ¤llningar (.env-fil):**
```env
GITHUB_TOKEN=your_github_personal_access_token
GITHUB_ENDPOINT=https://models.inference.ai.azure.com
GITHUB_MODEL_ID=gpt-4o-mini
```

**Ã–vervÃ¤ganden fÃ¶r samtidiga processer:**
```csharp
// Configure for concurrent operations
var clientOptions = new OpenAIClientOptions()
{
    Endpoint = new Uri(githubEndpoint),
    // Configure connection pooling for concurrent requests
    NetworkTimeout = TimeSpan.FromMinutes(5)
};
```

### ğŸ—ï¸ **Arkitektur fÃ¶r samtidiga arbetsflÃ¶den**

```mermaid
graph TD
    A[Workflow Input] --> B[Task Distribution]
    B --> C[Concurrent Agent Pool]
    C --> D[Agent Task 1]
    C --> E[Agent Task 2]
    C --> F[Agent Task 3]
    C --> G[Agent Task N]
    
    D --> H[Result Aggregation]
    E --> H
    F --> H
    G --> H
    
    H --> I[Synchronized Output]
    
    J[GitHub Models API] --> D
    J --> E
    J --> F
    J --> G
    
    K[.NET Task Scheduler] --> C
```

**Nyckelkomponenter:**
- **Task Parallel Library**: .NET:s inbyggda stÃ¶d fÃ¶r samtidiga operationer
- **Agentpool**: Flera agentinstanser fÃ¶r parallell bearbetning
- **Resultataggregation**: Samordning och sammanslagning av resultat frÃ¥n samtidiga agenter
- **Synkroniseringspunkter**: SÃ¤kerstÃ¤ll datakonsistens Ã¶ver samtidiga operationer

## ğŸ¨ **DesignmÃ¶nster fÃ¶r samtidiga arbetsflÃ¶den**

### ğŸ” **Parallell forskning och analys**
```
Research Topic â†’ Concurrent Research Agents â†’ Result Synthesis â†’ Final Report
```

### ğŸ“Š **Bearbetning av data frÃ¥n flera kÃ¤llor**
```
Data Sources â†’ Parallel Processing Agents â†’ Data Integration â†’ Unified Output
```

### ğŸ­ **InnehÃ¥llsgenereringspipeline**
```
Content Requirements â†’ Concurrent Content Generators â†’ Quality Review â†’ Final Content
```

### ğŸ”„ **Fan-Out/Fan-In-bearbetning**
```
Single Input â†’ Multiple Concurrent Processors â†’ Result Aggregation â†’ Single Output
```

## ğŸ¢ **FÃ¶retagsfÃ¶rdelar med hÃ¶g prestanda**

### âš¡ **GenomstrÃ¶mning och skalbarhet**
- **LinjÃ¤r prestandaskalning**: LÃ¤gg till fler samtidiga agenter fÃ¶r att Ã¶ka genomstrÃ¶mningen
- **Resursutnyttjande**: Maximal effektivitet av tillgÃ¤nglig AI-modellkapacitet
- **Minskad bearbetningstid**: Betydande tidsreduktion genom parallell kÃ¶rning
- **Elastisk skalning**: Justera antalet samtidiga agenter dynamiskt baserat pÃ¥ arbetsbelastning

### ğŸ›¡ï¸ **TillfÃ¶rlitlighet och motstÃ¥ndskraft**
- **Felisolering**: Enskilda agentfel pÃ¥verkar inte andra samtidiga operationer
- **GraciÃ¶s nedtrappning**: Systemet fortsÃ¤tter att fungera med reducerad agentkapacitet
- **FelÃ¥terhÃ¤mtning**: Automatiska Ã¥terfÃ¶rsÃ¶ksmekanismer fÃ¶r misslyckade samtidiga operationer
- **LastfÃ¶rdelning**: JÃ¤mn fÃ¶rdelning av arbete Ã¶ver tillgÃ¤ngliga agenter

### ğŸ“Š **PrestandaÃ¶vervakning**
- **Metrik fÃ¶r samtidiga operationer**: SpÃ¥ra prestanda fÃ¶r alla parallella operationer
- **ResursanvÃ¤ndningsanalys**: Ã–vervaka CPU-, minnes- och nÃ¤tverksanvÃ¤ndning
- **GenomstrÃ¶mningsanalys**: MÃ¤ta effektivitetsvinster frÃ¥n samtidiga processer
- **Flaskhalsdetektering**: Identifiera och lÃ¶sa prestandabegrÃ¤nsningar

### ğŸ”§ **Utveckling och drift**
- **Asynkron programmeringsmodell**: Utnyttja .NET:s mogna async/await-mÃ¶nster
- **Uppgiftskoordinering**: Inbyggd hantering och koordinering av uppgifter
- **Undantagshantering**: Omfattande felhantering fÃ¶r samtidiga operationer
- **FelsÃ¶kningsstÃ¶d**: Visual Studio-verktyg fÃ¶r felsÃ¶kning av samtidiga arbetsflÃ¶den

LÃ¥t oss bygga hÃ¶gpresterande samtidiga AI-arbetsflÃ¶den med .NET! ğŸš€

## ğŸ’» KÃ¶ra koden

Den kompletta implementeringen finns i `03.dotnet-agent-framework-workflow-ghmodel-concurrent.cs`. Denna fil demonstrerar ett **Fan-Out/Fan-In-samtidigt arbetsflÃ¶de** fÃ¶r reseplanering:

### ğŸ—ï¸ **ArbetsflÃ¶desarkitektur**

```
User Request â†’ ConcurrentStartExecutor â†’ [Researcher Agent || Planner Agent] â†’ ConcurrentAggregationExecutor â†’ Final Output
```

**Nyckelkomponenter:**

1. **ConcurrentStartExecutor**: Skickar anvÃ¤ndarfÃ¶rfrÃ¥gan till alla agenter samtidigt
2. **Researcher Agent**: Analyserar destinationer och sevÃ¤rdheter samtidigt
3. **Planner Agent**: Skapar detaljerade reseplaner samtidigt
4. **ConcurrentAggregationExecutor**: Samlar och sammanfogar resultat frÃ¥n bÃ¥da agenterna

### ğŸ¯ **Fan-Out/Fan-In-mÃ¶nster**

Detta arbetsflÃ¶de demonstrerar det klassiska **Fan-Out/Fan-In-mÃ¶nstret**:
- **Fan-Out**: Ett inmatningsmeddelande skickas till flera agenter samtidigt
- **Samtidig bearbetning**: Flera agenter arbetar parallellt med samma uppgift
- **Fan-In**: Resultat frÃ¥n alla agenter samlas och sammanfogas till en enda utmatning

### ğŸš€ KÃ¶ra exemplet

```bash
# Make the script executable (Unix/Linux/macOS)
chmod +x 03.dotnet-agent-framework-workflow-ghmodel-concurrent.cs

# Run the concurrent workflow
./03.dotnet-agent-framework-workflow-ghmodel-concurrent.cs
```

Eller pÃ¥ Windows:
```powershell
dotnet run 03.dotnet-agent-framework-workflow-ghmodel-concurrent.cs
```

### ğŸ“ FÃ¶rvÃ¤ntat resultat

ArbetsflÃ¶det kommer att:
1. **Skicka fÃ¶rfrÃ¥gan**: Skicka "Planera en resa till Seattle i december" till bÃ¥da agenterna
2. **Samtidig bearbetning**: BÃ¥da agenterna arbetar samtidigt:
   - Researcher identifierar sevÃ¤rdheter och detaljer
   - Planner skapar resplan och logistik
3. **Aggregation**: Kombinera bÃ¥da svaren till en omfattande utmatning
4. **Visa resultat**: Visa den sammanslagna reseplanen med all information

### ğŸ”§ Anpassningsalternativ

**LÃ¤gg till fler samtidiga agenter:**
```csharp
// Create additional specialized agents
AIAgent budgetAgent = openAIClient.GetChatClient(github_model_id).CreateAIAgent(
    name: "Budget-Agent", instructions: "Calculate travel costs...");

// Add to fan-out
var workflow = new WorkflowBuilder(startExecutor)
    .AddFanOutEdge(startExecutor, targets: [researcherAgent, plannerAgent, budgetAgent])
    .AddFanInEdge(aggregationExecutor, sources: [researcherAgent, plannerAgent, budgetAgent])
    .WithOutputFrom(aggregationExecutor)
    .Build();

// Update aggregation count
if (this._messages.Count == 3) { ... }
```

**Ã„ndra agentinstruktioner:**
```csharp
const string ResearcherAgentInstructions = "Your custom instructions for research...";
const string PlanAgentInstructions = "Your custom instructions for planning...";
```

**Ã„ndra uppgiften:**
```csharp
StreamingRun run = await InProcessExecution.StreamAsync(
    workflow, 
    "Plan a European vacation for 2 weeks in summer"
);
```

### ğŸ¯ Verkliga applikationer

Detta samtidiga mÃ¶nster Ã¤r idealiskt fÃ¶r:
- **InnehÃ¥llsskapande**: Flera skribenter skapar olika sektioner samtidigt
- **Kodgranskning**: Flera granskare analyserar kod frÃ¥n olika perspektiv
- **MarknadsundersÃ¶kning**: Parallell analys av olika marknadssegment
- **Dokumentbearbetning**: Samtidig extraktion, analys och validering
- **Multiperspektivanalys**: FÃ¥ olika synpunkter pÃ¥ samma inmatning

### ğŸ” FÃ¶rstÃ¥ anpassade exekutorer

**ConcurrentStartExecutor:**
- Implementerar `IMessageHandler<string>` fÃ¶r att acceptera strÃ¤nginmatning
- Skickar meddelanden till alla anslutna agenter
- Skickar `TurnToken` fÃ¶r att trigga samtidiga processer

**ConcurrentAggregationExecutor:**
- Implementerar `IMessageHandler<ChatMessage>` fÃ¶r att ta emot agentrespons
- Samlar meddelanden pÃ¥ ett trÃ¥dsÃ¤kert sÃ¤tt
- Aggregerar nÃ¤r alla fÃ¶rvÃ¤ntade svar har anlÃ¤nt
- Ger slutlig utmatning med `context.YieldOutputAsync()`

### âš¡ PrestandafÃ¶rdelar

**Samtidigt vs Sekventiellt:**
- Sekventiellt: Agent1 (30s) â†’ Agent2 (30s) = **60 sekunder totalt**
- Samtidigt: Agent1 (30s) || Agent2 (30s) = **30 sekunder totalt**

**GenomstrÃ¶mningsfÃ¶rbÃ¤ttring**: Upp till NÃ— snabbare fÃ¶r N samtidiga agenter (beroende pÃ¥ arbetsbelastning och resurser)

### ğŸ›¡ï¸ Felhantering

ArbetsflÃ¶det hanterar enskilda agentfel graciÃ¶st:
- Om en agent misslyckas fortsÃ¤tter andra att bearbeta
- Aggregator kan implementera timeout-logik
- Partiella resultat kan returneras vid behov

### ğŸ“Š Avancerade funktioner

**Dynamiskt antal agenter:**
Ã„ndra aggregationslogiken fÃ¶r att stÃ¶dja variabelt antal agenter:

```csharp
private int _expectedAgentCount;
private readonly List<ChatMessage> _messages = [];

public async ValueTask HandleAsync(ChatMessage message, IWorkflowContext context)
{
    this._messages.Add(message);
    if (this._messages.Count == _expectedAgentCount)
    {
        // Process aggregation
    }
}
```

Detta samtidiga arbetsflÃ¶desmÃ¶nster Ã¤r avgÃ¶rande fÃ¶r att bygga hÃ¶gpresterande, skalbara AI-agentssystem!

---

<!-- CO-OP TRANSLATOR DISCLAIMER START -->
**Ansvarsfriskrivning**:  
Detta dokument har Ã¶versatts med hjÃ¤lp av AI-Ã¶versÃ¤ttningstjÃ¤nsten [Co-op Translator](https://github.com/Azure/co-op-translator). Ã„ven om vi strÃ¤var efter noggrannhet, bÃ¶r du vara medveten om att automatiserade Ã¶versÃ¤ttningar kan innehÃ¥lla fel eller felaktigheter. Det ursprungliga dokumentet pÃ¥ dess modersmÃ¥l bÃ¶r betraktas som den auktoritativa kÃ¤llan. FÃ¶r kritisk information rekommenderas professionell mÃ¤nsklig Ã¶versÃ¤ttning. Vi ansvarar inte fÃ¶r eventuella missfÃ¶rstÃ¥nd eller feltolkningar som uppstÃ¥r vid anvÃ¤ndning av denna Ã¶versÃ¤ttning.
<!-- CO-OP TRANSLATOR DISCLAIMER END -->