<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "5cc6836626047aa055e8960c8484a7d0",
  "translation_date": "2025-10-11T11:29:52+00:00",
  "source_file": "11-agentic-protocols/code_samples/mcp-agents/README.md",
  "language_code": "ta"
}
-->
# MCP роорпВро▓роорпН роорпБроХро╡ро░рпН-роорпБроХро╡ро░рпН родрпКроЯро░рпНрокрпБ роЕроорпИрокрпНрокрпБроХро│рпИ роЙро░рпБро╡ро╛роХрпНроХрпБродро▓рпН

> TL;DR - MCP-ро▓рпН Agent2Agent родрпКроЯро░рпНрокрпБ роЕроорпИроХрпНроХ роорпБроЯро┐ропрпБрооро╛? роорпБроЯро┐ропрпБроорпН!

MCP роЕродройрпН роЖро░роорпНрок роирпЛроХрпНроХрооро╛рой "LLMs-роХрпНроХрпБ роЪрпВро┤ро▓рпИ ро╡ро┤роЩрпНроХрпБродро▓рпН" роОройрпНрокродрпИроХрпН роХроЯроирпНродрпБро╡ро┐роЯрпНроЯродрпБ. роЪроорпАрокродрпНродро┐роп роорпЗроорпНрокро╛роЯрпБроХро│рпН, [resumable streams](https://modelcontextprotocol.io/docs/concepts/transports#resumability-and-redelivery), [elicitation](https://modelcontextprotocol.io/specification/2025-06-18/client/elicitation), [sampling](https://modelcontextprotocol.io/specification/2025-06-18/client/sampling), рооро▒рпНро▒рпБроорпН роЕро▒ро┐ро╡ро┐рокрпНрокрпБроХро│рпН ([progress](https://modelcontextprotocol.io/specification/2025-06-18/basic/utilities/progress) рооро▒рпНро▒рпБроорпН [resources](https://modelcontextprotocol.io/specification/2025-06-18/schema#resourceupdatednotification)) роЖроХро┐ропро╡ро▒рпНро▒рпБроЯройрпН MCP роЗрокрпНрокрпЛродрпБ роЪро┐роХрпНроХро▓ро╛рой роорпБроХро╡ро░рпН-роорпБроХро╡ро░рпН родрпКроЯро░рпНрокрпБ роЕроорпИрокрпНрокрпБроХро│рпИ роЙро░рпБро╡ро╛роХрпНроХрпБро╡родро▒рпНроХро╛рой ро╡ро▓рпБро╡ро╛рой роЕроЯро┐родрпНродро│родрпНродрпИ ро╡ро┤роЩрпНроХрпБроХро┐ро▒родрпБ.

## роорпБроХро╡ро░рпН/роХро░рпБро╡ро┐ роХрпБро▒рпИрокро╛роЯрпБ

роорпБроХро╡ро░рпН роЪрпЖропро▓рпНрокро╛роЯрпБроХро│рпБроЯройрпН роХро░рпБро╡ро┐роХро│рпИ (роирпАрогрпНроЯ роирпЗро░роорпН роЗропроЩрпНроХрпБродро▓рпН, роЪрпЖропро▓рпНрокро╛роЯрпНроЯро┐ройрпН роироЯрпБро╡ро┐ро▓рпН роХрпВроЯрпБродро▓рпН роЙро│рпНро│рпАроЯрпБ родрпЗро╡рпИрокрпНрокроЯрпБродро▓рпН рокрпЛройрпНро▒ро╡рпИ) роЖро░ро╛ропрпБроорпН роорпЗроорпНрокро╛роЯрпНроЯро╛ро│ро░рпНроХро│рпН роЕродро┐роХро░ро┐родрпНродрпБро│рпНро│родро╛ро▓рпН, MCP роОро│ро┐роп роХрпЛро░ро┐роХрпНроХрпИ-рокродро┐ро▓рпН роорпБро▒рпИроорпИроХро│ро┐ро▓рпН роХро╡ройроорпН роЪрпЖро▓рпБродрпНродро┐ропродро╛ро▓рпН роЗродрпБ рокрпКро░рпБродрпНродрооро▒рпНро▒родрпБ роОройрпНро▒ родро╡ро▒ро╛рой роХро░рпБродрпНродрпБ роЙро░рпБро╡ро╛роХро┐ропрпБро│рпНро│родрпБ.

роЗроирпНрод рокро╛ро░рпНро╡рпИ рокро┤роорпИропро╛ройродрпБ. MCP ро╡ро┐ро╡ро░роХрпНроХрпБро▒ро┐рокрпНрокрпБ роХроЯроирпНрод роЪро┐ро▓ рооро╛родроЩрпНроХро│ро┐ро▓рпН роирпАрогрпНроЯ роирпЗро░роорпН роЗропроЩрпНроХрпБроорпН роорпБроХро╡ро░рпН роЪрпЖропро▓рпНрокро╛роЯрпБроХро│рпИ роЙро░рпБро╡ро╛роХрпНроХрпБро╡родро▒рпНроХро╛рой роЗроЯрпИро╡рпЖро│ро┐ропрпИ роорпВроЯрпБро╡родро▒рпНроХро╛рой родро┐ро▒ройрпНроХро│рпБроЯройрпН роХрпБро▒ро┐рокрпНрокро┐роЯродрпНродроХрпНроХ роЕро│ро╡ро┐ро▓рпН роорпЗроорпНрокроЯрпБродрпНродрокрпНрокроЯрпНроЯрпБро│рпНро│родрпБ:

- **Streaming & Partial Results**: роЪрпЖропро▓рпНрокро╛роЯрпНроЯро┐ройрпН рокрпЛродрпБ роирпЗро░роЯро┐ роорпБройрпНройрпЗро▒рпНро▒роорпН
- **Resumability**: ро╡ро╛роЯро┐роХрпНроХрпИропро╛ро│ро░рпНроХро│рпН родрпБрогрпНроЯро┐рокрпНрокрпБ рокро┐ро▒роХрпБ роорпАрогрпНроЯрпБроорпН роЗрогрпИроирпНродрпБ родрпКроЯро░ роорпБроЯро┐ропрпБроорпН
- **Durability**: роорпБроЯро┐ро╡рпБроХро│рпН роЪро░рпНро╡ро░рпН роорпАрогрпНроЯрпБроорпН родрпКроЯроЩрпНроХро┐роп рокро┐ро▒роХрпБроорпН роиро┐ро▓рпИродрпНродро┐ро░рпБроХрпНроХрпБроорпН (роЙродро╛ро░рогрооро╛роХ, resource links роорпВро▓роорпН)
- **Multi-turn**: роЪрпЖропро▓рпНрокро╛роЯрпНроЯро┐ройрпН роироЯрпБро╡ро┐ро▓рпН родрпКроЯро░рпНрокро╛роЯро▓рпН роорпВро▓роорпН роЙро│рпНро│рпАроЯрпБ

роЗроирпНрод роЕроорпНроЪроЩрпНроХро│рпН MCP роирпЖро▒ро┐роорпБро▒рпИропро┐ро▓рпН роЪро┐роХрпНроХро▓ро╛рой роорпБроХро╡ро░рпН рооро▒рпНро▒рпБроорпН рокро▓-роорпБроХро╡ро░рпН рокропройрпНрокро╛роЯрпБроХро│рпИ роЗропроХрпНроХрпБро╡родро▒рпНроХро╛роХ роЗрогрпИроХрпНроХрокрпНрокроЯро▓ро╛роорпН.

роЙродро╛ро░рогрооро╛роХ, MCP роЪро░рпНро╡ро░ро┐ро▓рпН роХро┐роЯрпИроХрпНроХрпБроорпН "роХро░рпБро╡ро┐" роОрой роТро░рпБ роорпБроХро╡ро░рпИ роХрпБро▒ро┐рокрпНрокро┐роЯрпБро╡рпЛроорпН. роЗродрпБ MCP ро╡ро╛роЯро┐роХрпНроХрпИропро╛ро│ро░рпН роЪрпЖропро▓рпНрокроЯрпБродрпНродрпБроорпН роТро░рпБ ро╣рпЛро╕рпНроЯрпН рокропройрпНрокро╛роЯрпНроЯро┐ройрпН роЗро░рпБрокрпНрокрпИ роХрпБро▒ро┐роХрпНроХро┐ро▒родрпБ, роЗродрпБ MCP роЪро░рпНро╡ро░рпБроЯройрпН роТро░рпБ роЕрооро░рпНро╡рпИ роиро┐ро▒рпБро╡ро┐ роорпБроХро╡ро░ро┐ропрпИ роЕро┤рпИроХрпНроХ роорпБроЯро┐ропрпБроорпН.

## MCP роХро░рпБро╡ро┐ "Agentic" роЖроХ роОройрпНрой роЪрпЖропрпНроХро┐ро▒родрпБ?

роЪрпЖропро▓рпНрокроЯрпБродрпНродрпБро╡родро▒рпНроХрпБ роорпБройрпН, роирпАрогрпНроЯ роирпЗро░роорпН роЗропроЩрпНроХрпБроорпН роорпБроХро╡ро░рпНроХро│рпИ роЖродро░ро┐роХрпНроХ родрпЗро╡рпИропро╛рой роЕроЯро┐родрпНродро│ родро┐ро▒ройрпНроХро│рпИ роиро┐ро▒рпБро╡рпБро╡рпЛроорпН.

> роирпАрогрпНроЯ роирпЗро░роорпН родройрпНройро╛роЯрпНроЪро┐ роЪрпЖропро▓рпНрокроЯроХрпНроХрпВроЯро┐роп, рокро▓ родрпКроЯро░рпНрокро╛роЯро▓рпНроХро│рпН роЕро▓рпНро▓родрпБ роирпЗро░роЯро┐ рокро┐ройрпНройрпВроЯрпНроЯродрпНродро┐ройрпН роЕроЯро┐рокрпНрокроЯрпИропро┐ро▓рпН роЪро░ро┐роЪрпЖропрпНродро▓рпН родрпЗро╡рпИрокрпНрокроЯрпБроорпН роЪро┐роХрпНроХро▓ро╛рой рокрогро┐роХро│рпИ роХрпИропро╛ро│роХрпНроХрпВроЯро┐роп роТро░рпБ роорпБроХро╡ро░рпИ роиро╛роорпН ро╡ро░рпИропро▒рпБроХрпНроХро┐ро▒рпЛроорпН.

### 1. Streaming & Partial Results

роЪро╛родро╛ро░рог роХрпЛро░ро┐роХрпНроХрпИ-рокродро┐ро▓рпН роорпБро▒рпИроорпИроХро│рпН роирпАрогрпНроЯ роирпЗро░роорпН роЗропроЩрпНроХрпБроорпН рокрогро┐роХро│рпБроХрпНроХрпБ рокрпКро░рпБродрпНродрооро▒рпНро▒ро╡рпИ. роорпБроХро╡ро░рпНроХро│рпБроХрпНроХрпБ родрпЗро╡рпИропро╛ройро╡рпИ:

- роирпЗро░роЯро┐ роорпБройрпНройрпЗро▒рпНро▒роорпН
- роЗроЯрпИроиро┐ро▓рпИ роорпБроЯро┐ро╡рпБроХро│рпН

**MCP роЖродро░ро╡рпБ**: Resource update notifications роорпВро▓роорпН streaming partial results-роР роЗропроХрпНроХ роорпБроЯро┐ропрпБроорпН, роЖройро╛ро▓рпН роЗродрпБ JSON-RPC роЗройрпН 1:1 роХрпЛро░ро┐роХрпНроХрпИ/рокродро┐ро▓рпН рооро╛роЯро▓рпБроЯройрпН роорпБро░рогрпНрокро╛роЯрпБроХро│рпИ родро╡ро┐ро░рпНроХрпНроХ роХро╡ройрооро╛роХ ро╡роЯро┐ро╡роорпИроХрпНроХ ро╡рпЗрогрпНроЯрпБроорпН.

| роЕроорпНроЪроорпН                     | рокропройрпНрокро╛роЯрпНроЯрпБ роиро┐ро▓рпИ                                                                                                                                                                       | MCP роЖродро░ро╡рпБ                                                                                |
| -------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------ |
| роирпЗро░роЯро┐ роорпБройрпНройрпЗро▒рпНро▒роорпН | рокропройро░рпН роТро░рпБ codebase рооро╛ро▒рпНро▒рпБроорпН рокрогро┐ропрпИ роХрпЛро░рпБроХро┐ро▒ро╛ро░рпН. роорпБроХро╡ро░рпН роорпБройрпНройрпЗро▒рпНро▒родрпНродрпИ stream роЪрпЖропрпНроХро┐ро▒родрпБ: "10% - Dependencies роЖропрпНро╡рпБ... 25% - TypeScript роХрпЛрокрпНрокрпБроХро│рпИ рооро╛ро▒рпНро▒рпБродро▓рпН... 50% - Imports рокрпБродрпБрокрпНрокро┐родрпНродро▓рпН..."          | тЬЕ Progress notifications                                                                  |
| роЗроЯрпИроиро┐ро▓рпИ роорпБроЯро┐ро╡рпБроХро│рпН            | "Generate a book" рокрогро┐ропрпИ stream роЪрпЖропрпНроХро┐ро▒родрпБ, роЙродро╛ро░рогрооро╛роХ, 1) роХродрпИ ро╡ро│рпИро╡рпБ ро╡ро░рпИрокроЯроорпН, 2) роЕродрпНродро┐ропро╛роп рокроЯрпНроЯро┐ропро▓рпН, 3) роТро╡рпНро╡рпКро░рпБ роЕродрпНродро┐ропро╛ропроорпБроорпН роорпБроЯро┐роХрпНроХрокрпНрокроЯрпНроЯродрпБ. ро╣рпЛро╕рпНроЯрпН роЖропрпНро╡рпБ роЪрпЖропрпНроп, ро░родрпНродрпБ роЪрпЖропрпНроп роЕро▓рпНро▓родрпБ рооро╛ро▒рпНро▒ роорпБроЯро┐ропрпБроорпН. | тЬЕ Notifications "extended" роЪрпЖропрпНроп роорпБроЯро┐ропрпБроорпН, PR 383, 776 роЗро▓рпН роорпБройрпНроорпКро┤ро┐ро╡рпБроХро│рпИрокрпН рокро╛ро░рпНроХрпНроХро╡рпБроорпН |

<div align="center" style="font-style: italic; font-size: 0.95em; margin-bottom: 0.5em;">
<strong>рокроЯроорпН 1:</strong> роЗроирпНрод ро╡ро░рпИрокроЯроорпН MCP роорпБроХро╡ро░рпН роирпАрогрпНроЯ роирпЗро░роорпН роЗропроЩрпНроХрпБроорпН рокрогро┐ропро┐ройрпН рокрпЛродрпБ ро╣рпЛро╕рпНроЯрпН рокропройрпНрокро╛роЯрпНроЯро┐ро▒рпНроХрпБ роирпЗро░роЯро┐ роорпБройрпНройрпЗро▒рпНро▒роорпН рооро▒рпНро▒рпБроорпН роЗроЯрпИроиро┐ро▓рпИ роорпБроЯро┐ро╡рпБроХро│рпИ stream роЪрпЖропрпНроХро┐ро▒родрпБ, рокропройро░рпН роЪрпЖропро▓рпНрокро╛роЯрпНроЯрпИ роирпЗро░роЯро┐ропро╛роХ роХрогрпНроХро╛рогро┐роХрпНроХ роЕройрпБроородро┐роХрпНроХро┐ро▒родрпБ.
</div>

```mermaid
sequenceDiagram
    participant User
    participant Host as Host App<br/>(MCP Client)
    participant Server as MCP Server<br/>(Agent Tool)

    User->>Host: Start long task
    Host->>Server: Call agent_tool()

    loop Progress Updates
        Server-->>Host: Progress + partial results
        Host-->>User: Stream updates
    end

    Server-->>Host: тЬЕ Final result
    Host-->>User: Complete
```

### 2. Resumability

роорпБроХро╡ро░рпНроХро│рпН роирпЖроЯрпНро╡рпКро░рпНроХрпН роЗроЯрпИропрпВро▒рпБроХро│рпИ роЪрпАро░ро╛роХ роХрпИропро╛ро│ ро╡рпЗрогрпНроЯрпБроорпН:

- (ро╡ро╛роЯро┐роХрпНроХрпИропро╛ро│ро░рпН) родрпБрогрпНроЯро┐рокрпНрокрпБ рокро┐ро▒роХрпБ роорпАрогрпНроЯрпБроорпН роЗрогрпИрокрпНрокрпБ
- родро╛роЩрпНроХро│рпН роиро┐ро▒рпБродрпНродро┐роп роЗроЯродрпНродро┐ро▓ро┐ро░рпБроирпНродрпБ родрпКроЯро░рпБродро▓рпН (message redelivery)

**MCP роЖродро░ро╡рпБ**: MCP StreamableHTTP transport роЗройрпНро▒рпБ session resumption рооро▒рпНро▒рпБроорпН message redelivery-роР session IDs рооро▒рпНро▒рпБроорпН last event IDs роорпВро▓роорпН роЖродро░ро┐роХрпНроХро┐ро▒родрпБ. роЗроЩрпНроХрпБ роорпБроХрпНроХро┐ропрооро╛ройродрпБ, роЪро░рпНро╡ро░рпН EventStore-роР роЪрпЖропро▓рпНрокроЯрпБродрпНрод ро╡рпЗрогрпНроЯрпБроорпН, роЗродрпБ ро╡ро╛роЯро┐роХрпНроХрпИропро╛ро│ро░рпН роорпАрогрпНроЯрпБроорпН роЗрогрпИрокрпНрокрпБ роЪрпЖропрпНропрпБроорпН рокрпЛродрпБ роиро┐роХро┤рпНро╡рпБроХро│рпИ роорпАрогрпНроЯрпБроорпН роЗропроХрпНроХ роЕройрпБроородро┐роХрпНроХро┐ро▒родрпБ.  
роЪроорпВроХ роорпБройрпНроорпКро┤ро┐ро╡рпБ (PR #975) transport-agnostic resumable streams-роР роЖро░ро╛ропрпНроХро┐ро▒родрпБ.

| роЕроорпНроЪроорпН      | рокропройрпНрокро╛роЯрпНроЯрпБ роиро┐ро▓рпИ                                                                                                                                                   | MCP роЖродро░ро╡рпБ                                                                |
| ------------ | ---------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------- |
| Resumability | роирпАрогрпНроЯ роирпЗро░роорпН роЗропроЩрпНроХрпБроорпН рокрогро┐ропро┐ройрпН рокрпЛродрпБ ро╡ро╛роЯро┐роХрпНроХрпИропро╛ро│ро░рпН родрпБрогрпНроЯро┐роХрпНроХро┐ро▒родрпБ. роорпАрогрпНроЯрпБроорпН роЗрогрпИрокрпНрокрпБ роЪрпЖропрпНропрпБроорпН рокрпЛродрпБ, session IDs рооро▒рпНро▒рпБроорпН EventStore роорпВро▓роорпН роиро┐роХро┤рпНро╡рпБроХро│рпИ роорпАрогрпНроЯрпБроорпН роЗропроХрпНроХро┐ seamless-роЖроХ родрпКроЯро░рпБроХро┐ро▒родрпБ. | тЬЕ StreamableHTTP transport session IDs, event replay, рооро▒рпНро▒рпБроорпН EventStore |

<div align="center" style="font-style: italic; font-size: 0.95em; margin-bottom: 0.5em;">
<strong>рокроЯроорпН 2:</strong> роЗроирпНрод ро╡ро░рпИрокроЯроорпН MCP роЗройрпН StreamableHTTP transport рооро▒рпНро▒рпБроорпН EventStore session resumption-роР роОро╡рпНро╡ро╛ро▒рпБ роЪрпАро░ро╛роХ роЪрпЖропро▓рпНрокроЯрпБродрпНродрпБроХро┐ро▒родрпБ роОройрпНрокродрпИ роХро╛роЯрпНроЯрпБроХро┐ро▒родрпБ: ро╡ро╛роЯро┐роХрпНроХрпИропро╛ро│ро░рпН родрпБрогрпНроЯро┐роХрпНроХрпБроорпНрокрпЛродрпБ, роЕродрпБ роорпАрогрпНроЯрпБроорпН роЗрогрпИрокрпНрокрпБ роЪрпЖропрпНродрпБ, роиро┐роХро┤рпНро╡рпБроХро│рпИ роорпАрогрпНроЯрпБроорпН роЗропроХрпНроХро┐, роЪрпЖропро▓рпНрокро╛роЯрпНроЯрпИ роЗро┤рокрпНрокро┐ройрпНро▒ро┐ родрпКроЯро░ роорпБроЯро┐ропрпБроорпН.
</div>

```mermaid
sequenceDiagram
    participant User
    participant Host as Host App<br/>(MCP Client)
    participant Server as MCP Server<br/>(Agent Tool)
    participant Store as Event Store

    User->>Host: Start task
    Host->>Server: Call tool [session: abc123]
    Server->>Store: Save events

    Note over Host,Server: ЁЯТе Connection lost

    Host->>Server: Reconnect [session: abc123]
    Store-->>Server: Replay events
    Server-->>Host: Catch up + continue
    Host-->>User: тЬЕ Complete
```

### 3. Durability

роирпАрогрпНроЯ роирпЗро░роорпН роЗропроЩрпНроХрпБроорпН роорпБроХро╡ро░рпНроХро│рпБроХрпНроХрпБ роиро┐ро▓рпИропро╛рой роиро┐ро▓рпИ родрпЗро╡рпИ:

- роорпБроЯро┐ро╡рпБроХро│рпН роЪро░рпНро╡ро░рпН роорпАрогрпНроЯрпБроорпН родрпКроЯроЩрпНроХро┐роп рокро┐ро▒роХрпБроорпН роиро┐ро▓рпИродрпНродро┐ро░рпБроХрпНроХрпБроорпН
- роиро┐ро▓рпИропрпИ out-of-band-ро▓рпН рокрпЖро▒ роорпБроЯро┐ропрпБроорпН
- session-роХро│рпБроХрпНроХрпБ роЗроЯрпИропрпЗ роорпБройрпНройрпЗро▒рпНро▒родрпНродрпИ роХрогрпНроХро╛рогро┐родрпНродро▓рпН

**MCP роЖродро░ро╡рпБ**: MCP роЗрокрпНрокрпЛродрпБ Resource link return type-роР tool calls-роХрпНроХрпБ роЖродро░ро┐роХрпНроХро┐ро▒родрпБ. роЗройрпНро▒рпБ, роТро░рпБ resource-роР роЙро░рпБро╡ро╛роХрпНроХро┐ resource link-роР роЙроЯройроЯро┐ропро╛роХ родро┐ро░рпБрокрпНрокро┐ роЕройрпБрокрпНрокрпБроорпН tool-роР ро╡роЯро┐ро╡роорпИрокрпНрокродрпБ роТро░рпБ роЪро╛родрпНродро┐ропрооро╛рой роорпБро▒рпИ. роЗроирпНрод tool рокро┐ройрпНройрогро┐ропро┐ро▓рпН рокрогро┐ропрпИ родрпКроЯро░ роорпБроЯро┐ропрпБроорпН рооро▒рпНро▒рпБроорпН resource-роР рокрпБродрпБрокрпНрокро┐роХрпНроХ роорпБроЯро┐ропрпБроорпН. роЗродройро╛ро▓рпН, ро╡ро╛роЯро┐роХрпНроХрпИропро╛ро│ро░рпН resource-роЗройрпН роиро┐ро▓рпИропрпИ poll роЪрпЖропрпНроп partial роЕро▓рпНро▓родрпБ роорпБро┤рпБ роорпБроЯро┐ро╡рпБроХро│рпИрокрпН рокрпЖро▒ роорпБроЯро┐ропрпБроорпН (роЪро░рпНро╡ро░рпН ро╡ро┤роЩрпНроХрпБроорпН resource updates роЕроЯро┐рокрпНрокроЯрпИропро┐ро▓рпН) роЕро▓рпНро▓родрпБ resource-роХрпНроХрпБ update notifications-роР subscribe роЪрпЖропрпНроп роорпБроЯро┐ропрпБроорпН.

роЗроЩрпНроХрпБ роТро░рпБ ро╡ро░роорпНрокрпБ роОройрпНройро╡рпЖройрпНро▒ро╛ро▓рпН, resources-роР poll роЪрпЖропрпНро╡родрпБ роЕро▓рпНро▓родрпБ updates-роХрпНроХрпБ subscribe роЪрпЖропрпНро╡родрпБ resources-роР рокропройрпНрокроЯрпБродрпНродрпБро╡родрпБроЯройрпН, роЕро│ро╡ро┐ро▓ро╛рой ро╡ро┐ро│рпИро╡рпБроХро│рпИ роПро▒рпНрокроЯрпБродрпНродрпБроорпН. роЗродро▒рпНроХро╛рой community proposal (роЙро│рпНро│роЯроХрпНроХроорпН #992) webhooks роЕро▓рпНро▓родрпБ triggers-роР роЪрпЗро░рпНроХрпНроХрпБроорпН роЪро╛родрпНродро┐ропродрпНродрпИ роЖро░ро╛ропрпНроХро┐ро▒родрпБ, роЗродрпБ updates-роР client/host application-роХрпНроХрпБ роЕро▒ро┐ро╡ро┐роХрпНроХ роЪро░рпНро╡ро░рпН роЕро┤рпИроХрпНроХ роЕройрпБроородро┐роХрпНроХро┐ро▒родрпБ.

| роЕроорпНроЪроорпН    | рокропройрпНрокро╛роЯрпНроЯрпБ роиро┐ро▓рпИ                                                                                                                                        | MCP роЖродро░ро╡рпБ                                                        |
| ---------- | ----------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------ |
| Durability | роЪро░рпНро╡ро░рпН data migration task-роЗро▓рпН crash роЖроХро┐ро▒родрпБ. роорпБроЯро┐ро╡рпБроХро│рпН рооро▒рпНро▒рпБроорпН роорпБройрпНройрпЗро▒рпНро▒роорпН restart-роХрпНроХрпБ рокро┐ро▒роХрпБроорпН роиро┐ро▓рпИродрпНродро┐ро░рпБроХрпНроХрпБроорпН, client роиро┐ро▓рпИропрпИроЪрпН роЪро░ро┐рокро╛ро░рпНродрпНродрпБ роиро┐ро▓рпИропро╛рой resource-роЗро▓рпН роЗро░рпБроирпНродрпБ родрпКроЯро░ роорпБроЯро┐ропрпБроорпН. | тЬЕ Resource links persistent storage рооро▒рпНро▒рпБроорпН status notifications |

роЗройрпНро▒рпБ, resource-роР роЙро░рпБро╡ро╛роХрпНроХро┐ resource link-роР роЙроЯройроЯро┐ропро╛роХ родро┐ро░рпБрокрпНрокро┐ роЕройрпБрокрпНрокрпБроорпН tool-роР ро╡роЯро┐ро╡роорпИрокрпНрокродрпБ роТро░рпБ рокрпКродрпБро╡ро╛рой роорпБро▒рпИ. роЗроирпНрод tool рокро┐ройрпНройрогро┐ропро┐ро▓рпН task-роР address роЪрпЖропрпНродрпБ, resource notifications-роР progress updates-роЖроХ issue роЪрпЖропрпНродрпБ роЕро▓рпНро▓родрпБ partial results-роР роЪрпЗро░рпНродрпНродрпБ, resource-роЗро▓рпН роЙро│рпНро│роЯроХрпНроХродрпНродрпИ родрпЗро╡рпИропро╛ройрокроЯро┐ рокрпБродрпБрокрпНрокро┐роХрпНроХ роорпБроЯро┐ропрпБроорпН.

<div align="center" style="font-style: italic; font-size: 0.95em; margin-bottom: 0.5em;">
<strong>рокроЯроорпН 3:</strong> роЗроирпНрод ро╡ро░рпИрокроЯроорпН MCP роорпБроХро╡ро░рпНроХро│рпН persistent resources рооро▒рпНро▒рпБроорпН status notifications-роР рокропройрпНрокроЯрпБродрпНродро┐ роирпАрогрпНроЯ роирпЗро░роорпН роЗропроЩрпНроХрпБроорпН рокрогро┐роХро│рпН роЪро░рпНро╡ро░рпН роорпАрогрпНроЯрпБроорпН родрпКроЯроЩрпНроХро┐роп рокро┐ро▒роХрпБроорпН роиро┐ро▓рпИродрпНродро┐ро░рпБроХрпНроХрпБроорпН, ро╡ро╛роЯро┐роХрпНроХрпИропро╛ро│ро░рпНроХро│рпН роорпБройрпНройрпЗро▒рпНро▒родрпНродрпИроЪрпН роЪро░ро┐рокро╛ро░рпНродрпНродрпБ родрпЛро▓рпНро╡ро┐роХро│рпБроХрпНроХрпБрокрпН рокро┐ро▒роХрпБроорпН роорпБроЯро┐ро╡рпБроХро│рпИрокрпН рокрпЖро▒ роЕройрпБроородро┐роХрпНроХро┐ро▒родрпБ.
</div>

```mermaid
sequenceDiagram
    participant User
    participant Host as Host App<br/>(MCP Client)
    participant Server as MCP Server<br/>(Agent Tool)
    participant DB as Persistent Storage

    User->>Host: Start task
    Host->>Server: Call tool
    Server->>DB: Create resource + updates
    Server-->>Host: ЁЯФЧ Resource link

    Note over Server: ЁЯТе Server restart

    User->>Host: Check status
    Host->>Server: Get resource
    Server->>DB: Load state
    Server-->>Host: Current progress
    Server->>DB: Complete + notify
    Host-->>User: тЬЕ Complete
```

### 4. Multi-Turn Interactions

роорпБроХро╡ро░рпНроХро│рпБроХрпНроХрпБ роЪрпЖропро▓рпНрокро╛роЯрпНроЯро┐ройрпН роироЯрпБро╡ро┐ро▓рпН роХрпВроЯрпБродро▓рпН роЙро│рпНро│рпАроЯрпБ родрпЗро╡рпИрокрпНрокроЯрпБроорпН:

- рооройро┐род ро╡ро┐ро│роХрпНроХроорпН роЕро▓рпНро▓родрпБ роТрокрпНрокрпБродро▓рпН
- роЪро┐роХрпНроХро▓ро╛рой роорпБроЯро┐ро╡рпБроХро│рпБроХрпНроХрпБ AI роЙродро╡ро┐
- рооро╛ро▒рпБроорпН роЕро│ро╡рпБро░рпБ роЪро░ро┐роЪрпЖропрпНродро▓рпН

**MCP роЖродро░ро╡рпБ**: Sampling (AI input-роХрпНроХрпБ) рооро▒рпНро▒рпБроорпН elicitation (рооройро┐род input-роХрпНроХрпБ) роорпВро▓роорпН роорпБро┤рпБроорпИропро╛роХ роЖродро░ро┐роХрпНроХрокрпНрокроЯрпБроХро┐ро▒родрпБ.

| роЕроорпНроЪроорпН                 | рокропройрпНрокро╛роЯрпНроЯрпБ роиро┐ро▓рпИ                                                                                                                                     | MCP роЖродро░ро╡рпБ                                           |
| ----------------------- | -------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------- |
| Multi-Turn Interactions | рокропрог роорпБройрпНрокродро┐ро╡рпБ роорпБроХро╡ро░рпН рокропройро░рпН ро╡ро┐ро▓рпИропрпИ роЙро▒рпБродро┐рокрпНрокроЯрпБродрпНрод роХрпЛро░рпБроХро┐ро▒родрпБ, рокро┐ройрпНройро░рпН рокропрог родро░ро╡рпБроХро│рпИ роЪрпБро░рпБроХрпНроХ AI-роР роХрпЗроЯрпНроХро┐ро▒родрпБ, роорпБройрпНрокродро┐ро╡рпБ рокро░ро┐ро╡ро░рпНродрпНродройрпИ роорпБроЯро┐роХрпНроХро┐ро▒родрпБ. | тЬЕ Elicitation рооройро┐род input-роХрпНроХрпБ, sampling AI input-роХрпНроХрпБ |

<div align="center" style="font-style: italic; font-size: 0.95em; margin-bottom: 0.5em;">
<strong>рокроЯроорпН 4:</strong> роЗроирпНрод ро╡ро░рпИрокроЯроорпН MCP роорпБроХро╡ро░рпНроХро│рпН роЪрпЖропро▓рпНрокро╛роЯрпНроЯро┐ройрпН роироЯрпБро╡ро┐ро▓рпН рооройро┐род input-роР interactively elicitation роорпВро▓роорпН роЕро▓рпНро▓родрпБ AI роЙродро╡ро┐ропрпИ роХрпЗроЯрпНроХ sampling роорпВро▓роорпН, роЪро┐роХрпНроХро▓ро╛рой, multi-turn workflows-роР роЖродро░ро┐роХрпНроХро┐ро▒родрпБ, роЙродро╛ро░рогрооро╛роХ роЙро▒рпБродро┐рокрпНрокро╛роЯрпБроХро│рпН рооро▒рпНро▒рпБроорпН рооро╛ро▒рпБроорпН роорпБроЯро┐ро╡рпЖроЯрпБрокрпНрокрпБроХро│рпН.
</div>

```mermaid
sequenceDiagram
    participant User
    participant Host as Host App<br/>(MCP Client)
    participant Server as MCP Server<br/>(Agent Tool)

    User->>Host: Book flight
    Host->>Server: Call travel_agent

    Server->>Host: Elicitation: "Confirm $500?"
    Note over Host: Elicitation callback (if available)
    Host->>User: ЁЯТ░ Confirm price?
    User->>Host: "Yes"
    Host->>Server: Confirmed

    Server->>Host: Sampling: "Summarize data"
    Note over Host: AI callback (if available)
    Host->>Server: Report summary

    Server->>Host: тЬЕ Flight booked
```

## MCP-ро▓рпН роирпАрогрпНроЯ роирпЗро░роорпН роЗропроЩрпНроХрпБроорпН роорпБроХро╡ро░рпНроХро│рпИ роЪрпЖропро▓рпНрокроЯрпБродрпНродрпБродро▓рпН - роХрпБро▒ро┐ропрпАроЯрпНроЯрпБ роХрогрпНрогрпЛроЯрпНроЯроорпН

роЗроирпНрод роХроЯрпНроЯрпБро░рпИропро┐ройрпН роТро░рпБ рокроХрпБродро┐ропро╛роХ, [code repository](https://github.com/victordibia/ai-tutorials/tree/main/MCP%20Agents) MCP Python SDK рооро▒рпНро▒рпБроорпН StreamableHTTP transport-роР session resumption рооро▒рпНро▒рпБроорпН message redelivery-роХрпНроХрпБ рокропройрпНрокроЯрпБродрпНродро┐ роирпАрогрпНроЯ роирпЗро░роорпН роЗропроЩрпНроХрпБроорпН роорпБроХро╡ро░рпНроХро│рпИ роорпБро┤рпБроорпИропро╛роХ роЪрпЖропро▓рпНрокроЯрпБродрпНродрпБроорпН роТро░рпБ роЪрпЖропро▓рпНрокро╛роЯрпНроЯрпИ роХрпКрогрпНроЯрпБро│рпНро│родрпБ. MCP родро┐ро▒ройрпНроХро│рпИ роЪро┐роХрпНроХро▓ро╛рой роорпБроХро╡ро░рпН рокрпЛройрпНро▒ роЪрпЖропро▓рпНрокро╛роЯрпБроХро│рпИ роЗропроХрпНроХрпБро╡родро▒рпНроХро╛роХ роОрокрпНрокроЯро┐ роЗрогрпИроХрпНроХ роорпБроЯро┐ропрпБроорпН роОройрпНрокродрпИ роЗроирпНрод роЪрпЖропро▓рпНрокро╛роЯрпБ роХро╛роЯрпНроЯрпБроХро┐ро▒родрпБ.

роХрпБро▒ро┐рокрпНрокро╛роХ, роЗро░рогрпНроЯрпБ роорпБроХрпНроХро┐роп роорпБроХро╡ро░рпН роХро░рпБро╡ро┐роХро│рпБроЯройрпН роТро░рпБ роЪро░рпНро╡ро░рпИ роЪрпЖропро▓рпНрокроЯрпБродрпНродрпБроХро┐ро▒рпЛроорпН:

- **Travel Agent** - elicitation роорпВро▓роорпН ро╡ро┐ро▓рпИ роЙро▒рпБродро┐рокрпНрокро╛роЯрпНроЯрпБроЯройрпН рокропрог роорпБройрпНрокродро┐ро╡рпБ роЪрпЗро╡рпИропрпИ simulation роЪрпЖропрпНроХро┐ро▒родрпБ
- **Research Agent** - sampling роорпВро▓роорпН AI-assisted роЪрпБро░рпБроХрпНроХроЩрпНроХро│рпИрокрпН рокропройрпНрокроЯрпБродрпНродро┐ роЖро░ро╛ропрпНроЪрпНроЪро┐ рокрогро┐роХро│рпИроЪрпН роЪрпЖропрпНроХро┐ро▒родрпБ

роЗро░рогрпНроЯрпБ роорпБроХро╡ро░рпНроХро│рпБроорпН роирпЗро░роЯро┐ роорпБройрпНройрпЗро▒рпНро▒роорпН, interactive роЙро▒рпБродро┐рокрпНрокро╛роЯрпБроХро│рпН, рооро▒рпНро▒рпБроорпН роорпБро┤рпБ session resumption родро┐ро▒ройрпНроХро│рпИ роХро╛роЯрпНроЯрпБроХро┐ройрпНро▒рой.

### роорпБроХрпНроХро┐роп роЪрпЖропро▓рпНрокро╛роЯрпНроЯрпБ роХро░рпБродрпНродрпБроХрпНроХро│рпН

роХрпАро┤рпЗ роЙро│рпНро│ рокро┐ро░ро┐ро╡рпБроХро│рпН роТро╡рпНро╡рпКро░рпБ родро┐ро▒ройрпБроХрпНроХрпБроорпН роЪро░рпНро╡ро░рпН-рокроХрпНроХроорпН роорпБроХро╡ро░рпН роЪрпЖропро▓рпНрокроЯрпБродрпНродро▓рпН рооро▒рпНро▒рпБроорпН ро╡ро╛роЯро┐роХрпНроХрпИропро╛ро│ро░рпН-рокроХрпНроХроорпН ро╣рпЛро╕рпНроЯрпН роХрпИропро╛ро│рпБродро▓рпИроХрпН роХро╛роЯрпНроЯрпБроХро┐ройрпНро▒рой:

#### Streaming & Progress Updates - роирпЗро░роЯро┐ рокрогро┐ропро┐ройрпН роиро┐ро▓рпИ

Streaming роирпАрогрпНроЯ роирпЗро░роорпН роЗропроЩрпНроХрпБроорпН рокрогро┐роХро│ро┐ройрпН рокрпЛродрпБ роорпБроХро╡ро░рпНроХро│рпБроХрпНроХрпБ real-time progress updates ро╡ро┤роЩрпНроХ роЕройрпБроородро┐роХрпНроХро┐ро▒родрпБ, рокропройро░рпНроХро│рпИ task status рооро▒рпНро▒рпБроорпН роЗроЯрпИроиро┐ро▓рпИ роорпБроЯро┐ро╡рпБроХро│рпН роХрпБро▒ро┐родрпНродрпБ родроХро╡ро▓ро│ро┐роХрпНроХро┐ро▒родрпБ.

**роЪро░рпНро╡ро░рпН роЪрпЖропро▓рпНрокроЯрпБродрпНродро▓рпН (роорпБроХро╡ро░рпН progress notifications роЕройрпБрокрпНрокрпБроХро┐ро▒родрпБ):**

```python
# From server/server.py - Travel agent sending progress updates
for i, step in enumerate(steps):
    await ctx.session.send_progress_notification(
        progress_token=ctx.request_id,
        progress=i * 25,
        total=100,
        message=step,
        related_request_id=str(ctx.request_id)
    )
    await anyio.sleep(2)  # Simulate work

# Alternative: Log messages for detailed step-by-step updates
await ctx.session.send_log_message(
    level="info",
    data=f"Processing step {current_step}/{steps} ({progress_percent}%)",
    logger="long_running_agent",
    related_request_id=ctx.request_id,
)
```

**ро╡ро╛роЯро┐роХрпНроХрпИропро╛ро│ро░рпН роЪрпЖропро▓рпНрокроЯрпБродрпНродро▓рпН (ро╣рпЛро╕рпНроЯрпН progress updates рокрпЖро▒рпБроХро┐ро▒родрпБ):**

```python
# From client/client.py - Client handling real-time notifications
async def message_handler(message) -> None:
    if isinstance(message, types.ServerNotification):
        if isinstance(message.root, types.LoggingMessageNotification):
            console.print(f"ЁЯУб [dim]{message.root.params.data}[/dim]")
        elif isinstance(message.root, types.ProgressNotification):
            progress = message.root.params
            console.print(f"ЁЯФД [yellow]{progress.message} ({progress.progress}/{progress.total})[/yellow]")

# Register message handler when creating session
async with ClientSession(
    read_stream, write_stream,
    message_handler=message_handler
) as session:
```

#### Elicitation - рокропройро░рпН input роХрпЛро░рпБродро▓рпН

Elicitation роирпАрогрпНроЯ роирпЗро░роорпН роЗропроЩрпНроХрпБроорпН рокрогро┐роХро│ро┐ройрпН роироЯрпБро╡ро┐ро▓рпН роорпБроХро╡ро░рпНроХро│рпБроХрпНроХрпБ рокропройро░рпН input-роР роХрпЛро░ роЕройрпБроородро┐роХрпНроХро┐ро▒родрпБ. роЗродрпБ роЙро▒рпБродро┐рокрпНрокро╛роЯрпБроХро│рпН, ро╡ро┐ро│роХрпНроХроЩрпНроХро│рпН, роЕро▓рпНро▓родрпБ approvals-роХрпНроХрпБ роЕро╡роЪро┐ропрооро╛ройродрпБ.

**роЪро░рпНро╡ро░рпН роЪрпЖропро▓рпНрокроЯрпБродрпНродро▓рпН (роорпБроХро╡ро░рпН роЙро▒рпБродро┐рокрпНрокро╛роЯрпНроЯрпИ роХрпЛро░рпБроХро┐ро▒родрпБ):**

```python
# From server/server.py - Travel agent requesting price confirmation
elicit_result = await ctx.session.elicit(
    message=f"Please confirm the estimated price of $1200 for your trip to {destination}",
    requestedSchema=PriceConfirmationSchema.model_json_schema(),
    related_request_id=ctx.request_id,
)

if elicit_result and elicit_result.action == "accept":
    # Continue with booking
    logger.info(f"User confirmed price: {elicit_result.content}")
elif elicit_result and elicit_result.action == "decline":
    # Cancel the booking
    booking_cancelled = True
```

**ро╡ро╛роЯро┐роХрпНроХрпИропро╛ро│ро░рпН роЪрпЖропро▓рпНрокроЯрпБродрпНродро▓рпН (ро╣рпЛро╕рпНроЯрпН elicitation callback ро╡ро┤роЩрпНроХрпБроХро┐ро▒родрпБ):**

```python
# From client/client.py - Client handling elicitation requests
async def elicitation_callback(context, params):
    console.print(f"ЁЯТм Server is asking for confirmation:")
    console.print(f"   {params.message}")

    response = console.input("Do you accept? (y/n): ").strip().lower()

    if response in ['y', 'yes']:
        return types.ElicitResult(
            action="accept",
            content={"confirm": True, "notes": "Confirmed by user"}
        )
    else:
        return types.ElicitResult(
            action="decline",
            content={"confirm": False, "notes": "Declined by user"}
        )

# Register the callback when creating the session
async with ClientSession(
    read_stream, write_stream,
    elicitation_callback=elicitation_callback
) as session:
```

#### Sampling - AI роЙродро╡ро┐ропрпИ роХрпЛро░рпБродро▓рпН

Sampling роорпБроХро╡ро░рпНроХро│рпБроХрпНроХрпБ execution-роЗройрпН рокрпЛродрпБ роЪро┐роХрпНроХро▓ро╛рой роорпБроЯро┐ро╡рпБроХро│рпН роЕро▓рпНро▓родрпБ роЙро│рпНро│роЯроХрпНроХ роЙро░рпБро╡ро╛роХрпНроХродрпНродро┐ро▒рпНроХрпБ LLM роЙродро╡ро┐ропрпИ роХрпЛро░ роЕройрпБроородро┐роХрпНроХро┐ро▒родрпБ. роЗродрпБ рооройро┐род-AI роЗрогрпИроирпНрод workflows-роР роЗропроХрпНроХрпБроХро┐ро▒родрпБ.

**роЪро░рпНро╡ро░рпН роЪрпЖропро▓рпНрокроЯрпБродрпНродро▓рпН (роорпБроХро╡ро░рпН AI роЙродро╡ро┐ропрпИ роХрпЛро░рпБроХро┐ро▒родрпБ):**

```python
# From server/server.py - Research agent requesting AI summary
sampling_result = await ctx.session.create_message(
    messages=[
        SamplingMessage(
            role="user",
            content=TextContent(type="text", text=f"Please summarize the key findings for research on: {topic}")
        )
    ],
    max_tokens=100,
    related_request_id=ctx.request_id,
)

if sampling_result and sampling_result.content:
    if sampling_result.content.type == "text":
        sampling_summary = sampling_result.content.text
        logger.info(f"Received sampling summary: {sampling_summary}")
```

**ро╡ро╛роЯро┐роХрпНроХрпИропро╛ро│ро░рпН роЪрпЖропро▓рпНрокроЯрпБродрпНродро▓рпН (ро╣рпЛро╕рпНроЯрпН sampling callback ро╡ро┤роЩрпНроХрпБроХро┐ро▒родрпБ):**

```python
# From client/client.py - Client handling sampling requests
async def sampling_callback(context, params):
    message_text = params.messages[0].content.text if params.messages else 'No message'
    console.print(f"ЁЯза Server requested sampling: {message_text}")

    # In a real application, this could call an LLM API
    # For demo purposes, we provide a mock response
    mock_response = "Based on current research, MCP has evolved significantly..."

    return types.CreateMessageResult(
        role="assistant",
        content=types.TextContent(type="text", text=mock_response),
        model="interactive-client",
        stopReason="endTurn"
    )

# Register the callback when creating the session
async with ClientSession(
    read_stream, write_stream,
    sampling_callback=sampling_callback,
    elicitation_callback=elicitation_callback
) as session:
```

#### Resumability - родрпБрогрпНроЯро┐рокрпНрокрпБроХро│рпБроХрпНроХрпБ роЗроЯрпИропрпЗ session continuity

Resumability роирпАрогрпНроЯ роирпЗро░роорпН роЗропроЩрпНроХрпБроорпН роорпБроХро╡ро░рпН рокрогро┐роХро│рпН ро╡ро╛роЯро┐роХрпНроХрпИропро╛ро│ро░рпН родрпБрогрпНроЯро┐рокрпНрокрпБроХро│рпИродрпН родро╛рогрпНроЯро┐ роЙропро┐ро░рпНро╡ро╛ро┤рпНроирпНродрпБ, роорпАрогрпНроЯрпБроорпН роЗрогрпИрокрпНрокрпБ роЪрпЖропрпНропрпБроорпН рокрпЛродрпБ seamless-роЖроХ родрпКроЯро░ роЕройрпБроородро┐роХрпНроХро┐ро▒родрпБ. роЗродрпБ event stores рооро▒рпНро▒рпБроорпН resumption tokens роорпВро▓роорпН роЪрпЖропро▓рпНрокроЯрпБродрпНродрокрпНрокроЯрпБроХро┐ро▒родрпБ.

**Event Store роЪрпЖропро▓рпНрокроЯрпБродрпНродро▓рпН (роЪро░рпНро╡ро░рпН session state-роР ро╡рпИродрпНродро┐ро░рпБроХрпНроХро┐ро▒родрпБ):**

```python
# From server/event_store.py - Simple in-memory event store
class SimpleEventStore(EventStore):
    def __init__(self):
        self._events: list[tuple[StreamId, EventId, JSONRPCMessage]] = []
        self._event_id_counter = 0

    async def store_event(self, stream_id: StreamId, message: JSONRPCMessage) -> EventId:
        """Store an event and return its ID."""
        self._event_id_counter += 1
        event_id = str(self._event_id_counter)
        self._events.append((stream_id, event_id, message))
        return event_id

    async def replay_events_after(self, last_event_id: EventId, send_callback: EventCallback) -> StreamId | None:
        """Replay events after the specified ID for resumption."""
        # Find events after the last known event and replay them
        for _, event_id, message in self._events[start_index:]:
            await send_callback(EventMessage(message, event_id))

# From server/server.py - Passing event store to session manager
def create_server_app(event_store: Optional[EventStore] = None) -> Starlette:
    server = ResumableServer()

    # Create session manager with event store for resumption
    session_manager = StreamableHTTPSessionManager(
        app=server,
        event_store=event_store,  # Event store enables session resumption
        json_response=False,
        security_settings=security_settings,
    )

    return Starlette(routes=[Mount("/mcp", app=session_manager.handle_request)])

# Usage: Initialize with event store
event_store = SimpleEventStore()
app = create_server_app(event_store)
```

**ро╡ро╛роЯро┐роХрпНроХрпИропро╛ро│ро░рпН Metadata resumption token-роР роХрпКрогрпНроЯрпБ (stored state-роР рокропройрпНрокроЯрпБродрпНродро┐ client reconnect роЪрпЖропрпНроХро┐ро▒родрпБ):**

```python
# From client/client.py - Client resumption with metadata
if existing_tokens and existing_tokens.get("resumption_token"):
    # Use existing resumption token to continue where we left off
    metadata = ClientMessageMetadata(
        resumption_token=existing_tokens["resumption_token"],
    )
else:
    # Create callback to save resumption token when received
    def enhanced_callback(token: str):
        protocol_version = getattr(session, 'protocol_version', None)
        token_manager.save_tokens(session_id, token, protocol_version, command, args)

    metadata = ClientMessageMetadata(
        on_resumption_token_update=enhanced_callback,
    )

# Send request with resumption metadata
result = await session.send_request(
    types.ClientRequest(
        types.CallToolRequest(
            method="tools/call",
            params=types.CallToolRequestParams(name=command, arguments=args)
        )
    ),
    types.CallToolResult,
    metadata=metadata,
)
```

ро╣рпЛро╕рпНроЯрпН рокропройрпНрокро╛роЯрпБ session IDs рооро▒рпНро▒рпБроорпН resumption tokens-роР роЙро│рпНро│роЯроХрооро╛роХ ро╡рпИродрпНродро┐ро░рпБроХрпНроХро┐ро▒родрпБ, роЗродрпБ progress роЕро▓рпНро▓родрпБ state роЗро┤роХрпНроХро╛рооро▓рпН роЙро│рпНро│ session-роХро│рпБроХрпНроХрпБ роорпАрогрпНроЯрпБроорпН роЗрогрпИрокрпНрокрпБ роЪрпЖропрпНроп роЕройрпБроородро┐роХрпНроХро┐ро▒родрпБ.

### роХрпБро▒ро┐ропрпАроЯрпНроЯрпБ роЕроорпИрокрпНрокрпБ

<div align="center" style="font-style: italic; font-size: 0.95em; margin-bottom: 0.5em;">
<strong>рокроЯроорпН 5:</strong> MCP роЕроЯро┐рокрпНрокроЯрпИропро┐ро▓ро╛рой роорпБроХро╡ро░рпН роЕроорпИрокрпНрокрпБ роХроЯрпНроЯроорпИрокрпНрокрпБ
</div>

```mermaid
graph LR
    User([User]) -->|"Task"| Host["Host<br/>(MCP Client)"]
    Host -->|list tools| Server[MCP Server]
    Server -->|Exposes| AgentsTools[Agents as Tools]
    AgentsTools -->|Task| AgentA[Travel Agent]
    AgentsTools -->|Task| AgentB[Research Agent]

    Host -->|Monitors| StateUpdates[Progress & State Updates]
    Server -->|Publishes| StateUpdates

    class User user;
    class AgentA,AgentB agent;
    class Host,Server,StateUpdates core;
```

**роорпБроХрпНроХро┐роп роХрпЛрокрпНрокрпБроХро│рпН:**

- **`server/server.py`** - Resumable MCP server рокропрог рооро▒рпНро▒рпБроорпН роЖро░ро╛ропрпНроЪрпНроЪро┐ роорпБроХро╡ро░рпНроХро│рпБроЯройрпН, elicitation, sampling, рооро▒рпНро▒рпБроорпН progress updates-роР роХро╛роЯрпНроЯрпБроХро┐ро▒родрпБ
- **`client/client.py`** - Resumption роЖродро░ро╡рпБ, callback handlers, рооро▒рпНро▒рпБроорпН token management роХрпКрогрпНроЯ interactive host application
- **`server/event_store.py`** - Event store роЪрпЖропро▓рпНрокроЯрпБродрпНродро▓рпН session resumption рооро▒рпНро▒рпБроорпН message redelivery-роР роЗропроХрпНроХрпБроХро┐ро▒родрпБ

## MCP-ро▓рпН рокро▓-роорпБроХро╡ро░рпН родрпКроЯро░рпНрокрпБ роЕроорпИрокрпНрокрпБроХрпНроХрпБ ро╡ро┐ро░ро┐ро╡ро╛роХрпНроХроорпН

роорпЗро▓рпЗ роЙро│рпНро│ роЪрпЖропро▓рпНрокро╛роЯрпНроЯрпИ host рокропройрпНрокро╛роЯрпНроЯро┐ройрпН роирпБрогрпНрогро▒ро┐ро╡рпБ рооро▒рпНро▒рпБроорпН рокро░рокрпНрокрпИ роорпЗроорпНрокроЯрпБродрпНродрпБро╡родройрпН роорпВро▓роорпН рокро▓-роорпБроХро╡ро░рпН роЕроорпИрокрпНрокрпБроХро│рпБроХрпНроХрпБ ро╡ро┐ро░ро┐ро╡ро╛роХрпНроХ роорпБроЯро┐ропрпБроорпН:

- **Intelligent Task Decomposition**: Host роЪро┐роХрпНроХро▓ро╛рой рокропройро░рпН роХрпЛро░ро┐роХрпНроХрпИроХро│рпИ рокроХрпБрокрпНрокро╛ропрпНро╡рпБ роЪрпЖропрпНродрпБ, рокро▓ роЪро┐ро▒рокрпНрокрпБ роорпБроХро╡ро░рпНроХро│рпБроХрпНроХрпБ родрпБрогрпНроЯрпБ рокрогро┐роХро│рпИ рокро┐ро░ро┐роХрпНроХро┐ро▒родрпБ
- **Multi-Server Coordination**: Host рокро▓ MCP роЪро░рпНро╡ро░рпНроХро│рпБроЯройрпН роЗрогрпИрокрпНрокрпБроХро│рпИ рокро░ро╛рооро░ро┐роХрпНроХро┐ро▒родрпБ, роТро╡рпНро╡рпКройрпНро▒рпБроорпН ро╡рпЗро▒рпБрокроЯрпНроЯ роорпБроХро╡ро░рпН родро┐ро▒ройрпНроХро│рпИ ро╡рпЖро│ро┐рокрпНрокроЯрпБродрпНродрпБроХро┐ро▒родрпБ
- **Task State Management**: Host рокро▓ роТро░рпЗ роирпЗро░родрпНродро┐ро▓рпН роЗропроЩрпНроХрпБроорпН роорпБроХро╡ро░рпН рокрогро┐роХро│ро┐ройрпН роорпБройрпНройрпЗро▒рпНро▒родрпНродрпИ роХрогрпНроХро╛рогро┐роХрпНроХро┐ро▒родрпБ, роЪро╛ро░рпНрокрпБроХро│рпИ рооро▒рпНро▒рпБроорпН ро╡ро░ро┐роЪрпИропрпИ роХрпИропро╛ро│рпБроХро┐ро▒родрпБ
- **Resilience & Retries**: Host родрпЛро▓рпНро╡ро┐роХро│рпИ роиро┐ро░рпНро╡роХро┐роХрпНроХро┐ро▒родрпБ, retry logic-роР роЪрпЖропро▓рпНрокроЯрпБродрпНродрпБроХро┐ро▒родрпБ, рооро▒рпНро▒рпБроорпН роорпБроХро╡ро░рпНроХро│рпН роХро┐роЯрпИроХрпНроХро╛родрокрпЛродрпБ рокрогро┐роХро│рпИ reroute роЪрпЖропрпНроХро┐ро▒родрпБ
- **Result Synthesis**: Host рокро▓ роорпБроХро╡ро░рпНроХро│ро┐роЯрооро┐ро░рпБроирпНродрпБ output-роХро│рпИ роТро░рпБроЩрпНроХро┐рогрпИродрпНродрпБ cohesive роорпБроЯро┐ро╡рпБроХро│рпИ роЙро░рпБро╡ро╛роХрпНроХрпБроХро┐ро▒родрпБ

Host роТро░рпБ роОро│ро┐роп client-роЗро▓рпН роЗро░рпБроирпНродрпБ роТро░рпБ роирпБрогрпНрогро▒ро┐ро╡рпБ orchestrator роЖроХ рооро╛ро▒рпБроХро┐ро▒родрпБ, MCP protocol роЕроЯро┐родрпНродро│родрпНродрпИ рокро░ро╛рооро░ро┐роХрпНроХрпБроорпНрокрпЛродрпБ ро╡ро┐роиро┐ропрпЛроХро┐роХрпНроХрокрпНрокроЯрпНроЯ роорпБроХро╡ро░рпН родро┐ро▒ройрпНроХро│рпИ роТро░рпБроЩрпНроХро┐рогрпИроХрпНроХро┐ро▒родрпБ.

## роорпБроЯро┐ро╡рпБ

MCP роЗройрпН роорпЗроорпНрокроЯрпНроЯ родро┐ро▒ройрпНроХро│рпН - resource notifications, elicitation/sampling, resumable streams, рооро▒рпНро▒рпБроорпН persistent resources - роЪро┐роХрпНроХро▓ро╛рой роорпБроХро╡ро░рпН-роорпБроХро╡ро░рпН родрпКроЯро░рпНрокрпБроХро│рпИ роЗропроХрпНроХрпБроХро┐ро▒родрпБ, роЕродрпЗ роирпЗро░родрпНродро┐ро▓рпН роирпЖро▒ро┐роорпБро▒рпИ роОро│ро┐роорпИропрпИ рокро░ро╛рооро░ро┐роХрпНроХро┐ро▒родрпБ.

## родрпКроЯроЩрпНроХрпБродро▓рпН

роЙроЩрпНроХро│рпН роЪрпКроирпНрод agent2agent роЕроорпИрокрпНрокрпИ роЙро░рпБро╡ро╛роХрпНроХ родропро╛ро░ро╛? роЗроирпНрод рокроЯро┐роХро│рпИрокрпН рокро┐ройрпНрокро▒рпНро▒рпБроЩрпНроХро│рпН:

### 1. роЯрпЖроорпЛро╡рпИ роЗропроХрпНроХрпБроЩрпНроХро│рпН

```bash
# Start the server with event store for resumption
python -m server.server --port 8006

# In another terminal, run the interactive client
python -m client.client --url http://127.0.0.1:8006/mcp
```

**Interactive mode-ро▓рпН роХро┐роЯрпИроХрпНроХрпБроорпН роХроЯрпНроЯро│рпИроХро│рпН:**

- `travel_agent` - elicitation роорпВро▓роорпН ро╡ро┐ро▓рпИ роЙро▒рпБродро┐рокрпНрокро╛роЯрпНроЯрпБроЯройрпН рокропрог роорпБройрпНрокродро┐ро╡рпБ
- `research_agent` - sampling роорпВро▓роорпН AI-assisted роЪрпБро░рпБроХрпНроХроЩрпНроХро│рпБроЯройрпН роЖро░ро╛ропрпНроЪрпНроЪро┐
- `list` - роЕройрпИродрпНродрпБ роХро┐роЯрпИроХрпНроХрпБроорпН роХро░рпБро╡ро┐роХро│рпИрокрпН рокро╛ро░рпНроХрпНроХ
- `clean-tokens` - Resumption tokens-роР роЕро┤ро┐роХрпНроХ
- `help` - ро╡ро┐ро░ро┐ро╡ро╛рой роХроЯрпНроЯро│рпИ роЙродро╡ро┐ропрпИрокрпН рокро╛ро░рпНроХрпНроХ
- `quit` - client-роР ро╡рпЖро│ро┐ропрпЗро▒рпНро▒

### 2. Res
роорпКродрпНродродрпНродро┐ро▓рпН, MCP роирпЖро▒ро┐роорпБро▒рпИ ро╡ро┐ро╡ро░роХрпНроХрпБро▒ро┐рокрпНрокрпБ ро╡рпЗроХрооро╛роХ ро╡ро│ро░рпНроирпНродрпБ ро╡ро░рпБроХро┐ро▒родрпБ; роЪроорпАрокродрпНродро┐роп рокрпБродрпБрокрпНрокро┐рокрпНрокрпБроХро│рпИ роЕро▒ро┐роп ро╡ро╛роЪроХро░рпНроХро│рпН роЕродро┐роХро╛ро░рокрпНрокрпВро░рпНро╡ роЖро╡рог ро╡ро▓рпИродро│родрпНродрпИ рокро╛ро░рпНро╡рпИропро┐роЯрпБрооро╛ро▒рпБ роКроХрпНроХрпБро╡ро┐роХрпНроХрокрпНрокроЯрпБроХро┐ро▒ро╛ро░рпНроХро│рпН - https://modelcontextprotocol.io/introduction

---

**роХрпБро▒ро┐рокрпНрокрпБ**:  
роЗроирпНрод роЖро╡рогроорпН [Co-op Translator](https://github.com/Azure/co-op-translator) роОройрпНро▒ AI роорпКро┤ро┐рокрпЖропро░рпНрокрпНрокрпБ роЪрпЗро╡рпИропрпИрокрпН рокропройрпНрокроЯрпБродрпНродро┐ роорпКро┤ро┐рокрпЖропро░рпНроХрпНроХрокрпНрокроЯрпНроЯрпБро│рпНро│родрпБ. роиро╛роЩрпНроХро│рпН родрпБро▓рпНро▓ро┐ропродрпНродро┐ро▒рпНроХро╛роХ роорпБропро▒рпНроЪро┐роХрпНроХро┐ройрпНро▒рпЛроорпН, роЖройро╛ро▓рпН родро╛ройро┐ропроХрпНроХ роорпКро┤ро┐рокрпЖропро░рпНрокрпНрокрпБроХро│ро┐ро▓рпН рокро┐ро┤рпИроХро│рпН роЕро▓рпНро▓родрпБ родро╡ро▒ро╛рой родроХро╡ро▓рпНроХро│рпН роЗро░рпБроХрпНроХроХрпНроХрпВроЯрпБроорпН роОройрпНрокродрпИ родропро╡рпБроЪрпЖропрпНродрпБ роХро╡ройродрпНродро┐ро▓рпН роХрпКро│рпНро│рпБроЩрпНроХро│рпН. роЕродройрпН родро╛ропрпНроорпКро┤ро┐ропро┐ро▓рпН роЙро│рпНро│ роорпВро▓ роЖро╡рогроорпН роЕродро┐роХро╛ро░рокрпНрокрпВро░рпНро╡ роЖродро╛ро░рооро╛роХ роХро░рпБродрокрпНрокроЯ ро╡рпЗрогрпНроЯрпБроорпН. роорпБроХрпНроХро┐ропрооро╛рой родроХро╡ро▓рпНроХро│рпБроХрпНроХрпБ, родрпКро┤ро┐ро▓рпНроорпБро▒рпИ рооройро┐род роорпКро┤ро┐рокрпЖропро░рпНрокрпНрокрпБ рокро░ро┐роирпНродрпБро░рпИроХрпНроХрокрпНрокроЯрпБроХро┐ро▒родрпБ. роЗроирпНрод роорпКро┤ро┐рокрпЖропро░рпНрокрпНрокрпИрокрпН рокропройрпНрокроЯрпБродрпНродрпБро╡родро╛ро▓рпН роПро▒рпНрокроЯрпБроорпН роОроирпНрод родро╡ро▒ро╛рой рокрпБро░ро┐родро▓рпНроХро│рпН роЕро▓рпНро▓родрпБ родро╡ро▒ро╛рой ро╡ро┐ро│роХрпНроХроЩрпНроХро│рпБроХрпНроХрпБ роиро╛роЩрпНроХро│рпН рокрпКро▒рпБрокрпНрокро▓рпНро▓.