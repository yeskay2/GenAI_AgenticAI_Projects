<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "8abd335151cee553293b637ee3d80d10",
  "translation_date": "2025-11-11T12:00:27+00:00",
  "source_file": "08-multi-agent/code_samples/workflows-agent-framework/dotNET/04.dotnet-agent-framework-workflow-aifoundry-condition.md",
  "language_code": "es"
}
-->
# üîÄ Flujos de trabajo condicionales con Azure AI Foundry (.NET)

## üìã Tutorial de flujos de trabajo basados en decisiones inteligentes

Este cuaderno demuestra **patrones de flujo de trabajo condicional** utilizando Azure AI Foundry y el Microsoft Agent Framework para .NET. Aprender√°s a construir flujos de trabajo sofisticados, impulsados por decisiones, que enrutan el procesamiento de manera inteligente bas√°ndose en an√°lisis de IA, reglas empresariales y condiciones din√°micas para automatizaci√≥n de nivel empresarial.

## üéØ Objetivos de aprendizaje

### üß† **Arquitectura de decisiones inteligentes**
- **Implementaci√≥n de l√≥gica condicional**: Construir √°rboles de decisi√≥n complejos con m√∫ltiples puntos de ramificaci√≥n
- **Enrutamiento impulsado por IA**: Usar modelos de Azure AI Foundry para tomar decisiones de enrutamiento inteligentes
- **Adaptaci√≥n din√°mica del flujo de trabajo**: Modificar el comportamiento del flujo de trabajo basado en an√°lisis y condiciones en tiempo de ejecuci√≥n
- **Integraci√≥n de reglas empresariales**: Incorporar l√≥gica empresarial y requisitos de cumplimiento en los flujos de trabajo

### üîÄ **Patrones condicionales avanzados**
- **Toma de decisiones multicriterio**: Evaluar m√∫ltiples factores para decisiones de enrutamiento
- **Procesamiento consciente del contexto**: Tomar decisiones basadas en el contexto acumulado y el historial del flujo de trabajo
- **Modificaci√≥n adaptativa del flujo de trabajo**: Ajustar din√°micamente las rutas de procesamiento seg√∫n condiciones en tiempo real
- **Integraci√≥n de motores de reglas**: Implementar motores de reglas empresariales sofisticados dentro de los flujos de trabajo

### üè¢ **Aplicaciones condicionales empresariales**
- **Clasificaci√≥n y enrutamiento de documentos**: Clasificar y enrutar autom√°ticamente documentos a los flujos de trabajo apropiados
- **Triaje de servicio al cliente**: Enrutamiento inteligente de consultas de clientes a equipos especializados
- **Procesamiento de cumplimiento y riesgos**: Aplicar diferentes procesos de validaci√≥n y revisi√≥n basados en evaluaciones de riesgo
- **Flujos de trabajo de aseguramiento de calidad**: Enrutar contenido a trav√©s de procesos de revisi√≥n apropiados basados en m√©tricas de calidad

## ‚öôÔ∏è Requisitos previos y configuraci√≥n

### üì¶ **Paquetes NuGet requeridos**

Paquetes avanzados para procesamiento de flujos de trabajo condicional:

```xml
<!-- Core AI Framework -->
<PackageReference Include="Microsoft.Extensions.AI" Version="9.9.0" />

<!-- Azure AI Agents with Persistent State -->
<PackageReference Include="Azure.AI.Agents.Persistent" Version="1.2.0-beta.5" />

<!-- Azure Identity and Utilities -->
<PackageReference Include="Azure.Identity" Version="1.15.0" />
<PackageReference Include="System.Linq.Async" Version="6.0.3" />
<PackageReference Include="DotNetEnv" Version="3.1.1" />

<!-- Local Workflow Framework References -->
<!-- Microsoft.Agents.Workflows.dll - Advanced workflow orchestration -->
<!-- Microsoft.Agents.AI.AzureAI.dll - Azure AI Foundry integration -->
<!-- Microsoft.Agents.AI.dll - Core agent abstractions -->
```

### üîë **Configuraci√≥n de Azure AI Foundry**

**Recursos de Azure requeridos:**
- Espacio de trabajo de Azure AI Foundry con modelos de procesamiento condicional
- Suscripci√≥n de Azure con cuotas de c√≥mputo y permisos adecuados
- Modelos de IA implementados para toma de decisiones y an√°lisis de contenido
- (Opcional) Conexi√≥n a Bing Search API para capacidades de grounding

**Configuraci√≥n del entorno (.env file):**
```env
# Azure AI Foundry Configuration
AZURE_AI_PROJECT_ENDPOINT=https://your-project.cognitiveservices.azure.com/
BING_CONNECTION_ID=your-bing-connection-id
```

**Configuraci√≥n de autenticaci√≥n:**
```csharp
// Azure CLI or Managed Identity authentication
using Azure.Identity;
var credential = new AzureCliCredential();

// Load environment configuration
DotNetEnv.Env.Load("../../../.env");
```

### üèóÔ∏è **Arquitectura de flujo de trabajo condicional**

```mermaid
graph TD
    A[Input: Content Outline] --> B[Draft Executor]
    B --> C[Content Review Executor]
    C --> D{Review Decision}
    
    D -->|Yes - Approved| E[Publish Executor]
    D -->|No - Rejected| F[Send Review Executor]
    
    E --> G[Save as Markdown File]
    F --> H[Notify for Revisions]
    
    I[Azure AI Foundry] --> B
    I --> C
    I --> E
    
    J[Bing Grounding] --> B
```

**Componentes clave:**
- **Draft Executor**: Agente de IA que crea borradores iniciales de contenido a partir de esquemas
- **Content Review Executor**: Agente de IA que eval√∫a la calidad y el cumplimiento del borrador
- **Conditional Routing**: L√≥gica de decisi√≥n que enruta seg√∫n los resultados de la revisi√≥n
- **Publish/Review Paths**: Rutas de procesamiento separadas para contenido aprobado vs rechazado
- **State Management**: Mantiene el contexto de contenido y revisi√≥n a lo largo del flujo de trabajo

## üé® **Patrones de dise√±o de flujo de trabajo condicional**

### üìã **Producci√≥n de contenido con puertas de calidad**
```
Outline ‚Üí Draft Creation ‚Üí Quality Review ‚Üí {Approve: Publish | Reject: Revise}
```

### üéØ **Procesamiento de documentos basado en riesgos**
```
Document ‚Üí Risk Assessment ‚Üí {Low: Standard | High: Enhanced Review}
```

### üîç **Enrutamiento inteligente de servicio al cliente**
```
Customer Query ‚Üí Analysis ‚Üí {Simple: FAQ Bot | Complex: Human Agent}
```

### üíº **Flujos de trabajo impulsados por cumplimiento**
```
Content ‚Üí Compliance Check ‚Üí {Pass: Publish | Fail: Legal Review}
```

## üè¢ **Beneficios condicionales empresariales**

### üéØ **Automatizaci√≥n inteligente**
- **Toma de decisiones inteligente**: Decisiones de enrutamiento impulsadas por IA basadas en an√°lisis de contenido y contexto
- **Procesamiento adaptativo**: Flujos de trabajo que se ajustan autom√°ticamente seg√∫n condiciones cambiantes
- **Aplicaci√≥n de reglas empresariales**: Aplicaci√≥n autom√°tica de l√≥gica empresarial y pol√≠ticas complejas
- **Enrutamiento consciente del contexto**: Decisiones basadas en el historial completo del flujo de trabajo y el contexto acumulado

### üìà **Excelencia operativa**
- **Asignaci√≥n optimizada de recursos**: Enrutar trabajo a los especialistas y procesos m√°s apropiados
- **Reducci√≥n de intervenci√≥n manual**: La toma de decisiones automatizada minimiza la necesidad de enrutamiento humano
- **Tiempos de resoluci√≥n m√°s r√°pidos**: Enrutamiento directo a la experiencia y capacidades de procesamiento adecuadas
- **Aplicaci√≥n consistente**: Aplicaci√≥n uniforme de reglas empresariales y criterios de decisi√≥n

### üõ°Ô∏è **Gesti√≥n de riesgos y cumplimiento**
- **Evaluaci√≥n de riesgos automatizada**: Evaluaci√≥n impulsada por IA de niveles de riesgo de contenido y situaciones
- **Aplicaci√≥n de cumplimiento**: Enrutamiento autom√°tico a trav√©s de procesos regulatorios requeridos
- **Aplicaci√≥n de protocolos de seguridad**: Medidas de seguridad mejoradas aplicadas seg√∫n la evaluaci√≥n de riesgos
- **Mantenimiento de registros de auditor√≠a**: Documentaci√≥n completa de decisiones de enrutamiento y su justificaci√≥n

### üìä **An√°lisis y mejora continua**
- **An√°lisis de decisiones**: Seguimiento de la efectividad y precisi√≥n de las decisiones de enrutamiento
- **Reconocimiento de patrones**: Identificaci√≥n de tendencias y patrones en decisiones de enrutamiento a lo largo del tiempo
- **Optimizaci√≥n del rendimiento**: Mejora continua de los criterios de decisi√≥n y la eficiencia del enrutamiento
- **Inteligencia empresarial**: Informaci√≥n sobre caracter√≠sticas de contenido y requisitos de procesamiento

### üîß **Excelencia t√©cnica**
- **Gesti√≥n persistente del estado**: Mantener estados complejos a lo largo de la ejecuci√≥n del flujo de trabajo
- **Arquitectura escalable**: Manejar requisitos de procesamiento condicional de alto volumen
- **Capacidades de integraci√≥n**: Integraci√≥n fluida con sistemas y procesos empresariales existentes
- **Monitoreo y observabilidad**: Seguimiento integral del rendimiento y decisiones del flujo de trabajo

¬°Construyamos flujos de trabajo empresariales inteligentes y basados en decisiones con .NET! üöÄ

## üíª Ejecuci√≥n del c√≥digo

La implementaci√≥n completa est√° disponible en `04.dotnet-agent-framework-workflow-aifoundry-condition.cs`. Esto demuestra un **flujo de trabajo de producci√≥n de contenido con puertas de calidad**:

### üèóÔ∏è **Arquitectura del flujo de trabajo**

```
Content Outline ‚Üí Draft Creation ‚Üí Quality Review ‚Üí Conditional Routing:
                                                      ‚îú‚îÄ Approved (>200 words) ‚Üí Publish
                                                      ‚îî‚îÄ Rejected (<200 words) ‚Üí Review Notification
```

**Agentes en el flujo de trabajo:**
1. **Evangelist Agent**: Crea borradores de tutoriales a partir de esquemas con grounding de Bing
2. **Content Reviewer Agent**: Eval√∫a la calidad del borrador (conteo de palabras, integridad)
3. **Publisher Agent**: Guarda contenido aprobado como archivos Markdown con marca de tiempo

**Ejecutores personalizados:**
1. **DraftExecutor**: Orquesta la creaci√≥n de borradores
2. **ContentReviewExecutor**: Realiza la evaluaci√≥n de calidad
3. **PublishExecutor**: Maneja la publicaci√≥n de contenido aprobado
4. **SendReviewExecutor**: Gestiona las notificaciones de contenido rechazado

### üöÄ Ejecuci√≥n del ejemplo

**Requisitos previos:**
- Espacio de trabajo de Azure AI Foundry configurado
- Autenticaci√≥n de Azure CLI (`az login`)
- (Opcional) Conexi√≥n a Bing Search para grounding

```bash
# Make the script executable (Unix/Linux/macOS)
chmod +x 04.dotnet-agent-framework-workflow-aifoundry-condition.cs

# Run the conditional workflow
./04.dotnet-agent-framework-workflow-aifoundry-condition.cs
```

O en Windows:
```powershell
dotnet run 04.dotnet-agent-framework-workflow-aifoundry-condition.cs
```

### üìù Salida esperada

El flujo de trabajo:
1. **Crea agentes**: Inicializa tres agentes especializados de Azure AI Foundry
2. **Genera borrador**: El agente Evangelist crea un borrador de tutorial a partir de un esquema
3. **Revisa contenido**: El Content Reviewer eval√∫a la calidad del borrador
4. **Enrutamiento condicional**:
   - **Si aprobado (>200 palabras)**: El ejecutor de publicaci√≥n guarda como archivo Markdown
   - **Si rechazado (<200 palabras)**: Env√≠a notificaci√≥n de revisi√≥n
5. **Muestra resultados**: Presenta el resultado final del flujo de trabajo

### üîß Opciones de personalizaci√≥n

**Modificar criterios de revisi√≥n:**
```csharp
const string ContentReviewerInstructions = @"
You are a content reviewer...
1. Check if content is more than 500 words (instead of 200)
2. Verify technical accuracy
3. Ensure proper formatting
...";
```

**Agregar m√°s rutas condicionales:**
```csharp
var workflow = new WorkflowBuilder(draftExecutor)
    .AddEdge(draftExecutor, contentReviewerExecutor)
    .AddEdge(contentReviewerExecutor, publishExecutor, condition: GetCondition("Excellent"))
    .AddEdge(contentReviewerExecutor, editExecutor, condition: GetCondition("Good"))
    .AddEdge(contentReviewerExecutor, sendReviewerExecutor, condition: GetCondition("Poor"))
    .Build();
```

**Cambiar requisitos de contenido:**
```csharp
string OUTLINE_Content = @"
# Your Custom Topic
## Section 1
https://your-reference-url
## Section 2
...
";
```

### üéØ Aplicaciones en el mundo real

Este patr√≥n de flujo de trabajo condicional es ideal para:
- **Sistemas de gesti√≥n de contenido**: Flujos editoriales automatizados con puertas de calidad
- **Procesamiento de documentos**: Enrutar documentos seg√∫n clasificaci√≥n y cumplimiento
- **Soporte al cliente**: Enrutamiento inteligente de tickets seg√∫n complejidad y urgencia
- **Revisi√≥n legal**: Enrutar contratos seg√∫n evaluaci√≥n de riesgos y valor
- **Procesos de RRHH**: Enrutar aplicaciones a trav√©s de flujos de evaluaci√≥n adecuados

### üîç Entendiendo la l√≥gica condicional

**Funci√≥n de condici√≥n:**
```csharp
public Func<object?, bool> GetCondition(string expectedResult) =>
    reviewResult => reviewResult is ReviewResult review && review.Result == expectedResult;
```

Esta funci√≥n crea un predicado que:
1. Verifica si el resultado es del tipo `ReviewResult`
2. Compara la propiedad `Result` con el valor esperado
3. Devuelve verdadero/falso para determinar el enrutamiento

**Bordes del flujo de trabajo con condiciones:**
```csharp
.AddEdge(contentReviewerExecutor, publishExecutor, condition: GetCondition("Yes"))
.AddEdge(contentReviewerExecutor, sendReviewerExecutor, condition: GetCondition("No"))
```

### üìä Caracter√≠sticas avanzadas

**Validaci√≥n de esquema JSON:**
El flujo de trabajo utiliza esquemas JSON para garantizar respuestas estructuradas:

```csharp
// Define response structure
public class ReviewResult
{
    [JsonPropertyName("review_result")]
    public string Result { get; set; } = string.Empty;
    
    [JsonPropertyName("reason")]
    public string Reason { get; set; } = string.Empty;
    
    [JsonPropertyName("draft_content")]
    public string DraftContent { get; set; } = string.Empty;
}

// Apply to agent
ResponseFormat = ChatResponseFormat.ForJsonSchema(
    AIJsonUtilities.CreateJsonSchema(typeof(ReviewResult)), 
    "ReviewResult", 
    "Review Result From DraftContent"
)
```

**Integraci√≥n de grounding de Bing:**
El agente Evangelist utiliza grounding de Bing para acceder a informaci√≥n en tiempo real:

```csharp
var bingGroundingConfig = new BingGroundingSearchConfiguration(bing_conn_id);
BingGroundingToolDefinition bingGroundingTool = new(
    new BingGroundingSearchToolParameters([bingGroundingConfig])
);
```

Esto permite al agente seguir URLs en el esquema y extraer informaci√≥n actual.

### üõ°Ô∏è Manejo de errores

El flujo de trabajo incluye manejo robusto de errores para contenido rechazado:
- Las fallas de revisi√≥n activan la ruta alternativa
- Las notificaciones proporcionan razones claras de rechazo
- El contenido se conserva para revisi√≥n

### üîÑ Extensi√≥n del flujo de trabajo

**Agregar un bucle de revisi√≥n:**
Crear un bucle de retroalimentaci√≥n que vuelva a redactar contenido autom√°ticamente:

```csharp
.AddEdge(contentReviewerExecutor, publishExecutor, condition: GetCondition("Yes"))
.AddEdge(contentReviewerExecutor, draftExecutor, condition: GetCondition("No")) // Loop back
```

**Implementar revisi√≥n multinivel:**
Agregar m√∫ltiples etapas de revisi√≥n con diferentes criterios:

```csharp
.AddEdge(draftExecutor, technicalReviewer)
.AddEdge(technicalReviewer, editorialReviewer, condition: GetCondition("TechPass"))
.AddEdge(editorialReviewer, publishExecutor, condition: GetCondition("EditPass"))
```

¬°Este patr√≥n de flujo de trabajo condicional proporciona la base para construir sistemas de automatizaci√≥n empresarial sofisticados e inteligentes! üöÄ

---

<!-- CO-OP TRANSLATOR DISCLAIMER START -->
**Descargo de responsabilidad**:  
Este documento ha sido traducido utilizando el servicio de traducci√≥n autom√°tica [Co-op Translator](https://github.com/Azure/co-op-translator). Aunque nos esforzamos por lograr precisi√≥n, tenga en cuenta que las traducciones autom√°ticas pueden contener errores o imprecisiones. El documento original en su idioma nativo debe considerarse la fuente autorizada. Para informaci√≥n cr√≠tica, se recomienda una traducci√≥n profesional realizada por humanos. No nos hacemos responsables de malentendidos o interpretaciones err√≥neas que surjan del uso de esta traducci√≥n.
<!-- CO-OP TRANSLATOR DISCLAIMER END -->