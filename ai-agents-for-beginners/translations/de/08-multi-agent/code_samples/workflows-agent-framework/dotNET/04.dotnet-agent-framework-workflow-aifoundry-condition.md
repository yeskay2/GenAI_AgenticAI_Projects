<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "8abd335151cee553293b637ee3d80d10",
  "translation_date": "2025-11-11T12:01:06+00:00",
  "source_file": "08-multi-agent/code_samples/workflows-agent-framework/dotNET/04.dotnet-agent-framework-workflow-aifoundry-condition.md",
  "language_code": "de"
}
-->
# ğŸ”€ Bedingte Agenten-Workflows mit Azure AI Foundry (.NET)

## ğŸ“‹ Tutorial fÃ¼r intelligente, entscheidungsbasierte Workflows

Dieses Notebook demonstriert **bedingte Workflow-Muster** mit Azure AI Foundry und dem Microsoft Agent Framework fÃ¼r .NET. Sie lernen, wie man komplexe, entscheidungsgetriebene Workflows erstellt, die die Verarbeitung basierend auf KI-Analysen, GeschÃ¤ftsregeln und dynamischen Bedingungen intelligent steuern, um Automatisierung auf Unternehmensniveau zu ermÃ¶glichen.

## ğŸ¯ Lernziele

### ğŸ§  **Architektur fÃ¼r intelligente Entscheidungen**
- **Implementierung von bedingter Logik**: Erstellen Sie komplexe EntscheidungsbÃ¤ume mit mehreren Verzweigungspunkten
- **KI-gesteuerte Steuerung**: Nutzen Sie Azure AI Foundry-Modelle, um intelligente Routing-Entscheidungen zu treffen
- **Dynamische Workflow-Anpassung**: Ã„ndern Sie das Workflow-Verhalten basierend auf Laufzeitanalysen und Bedingungen
- **Integration von Unternehmensregeln**: Integrieren Sie GeschÃ¤ftslogik und Compliance-Anforderungen in Workflows

### ğŸ”€ **Fortgeschrittene bedingte Muster**
- **Entscheidungen basierend auf mehreren Kriterien**: Bewerten Sie mehrere Faktoren fÃ¼r Routing-Entscheidungen
- **Kontextbewusste Verarbeitung**: Treffen Sie Entscheidungen basierend auf angesammeltem Workflow-Kontext und Historie
- **Adaptive Workflow-Modifikation**: Passen Sie Verarbeitungswege dynamisch basierend auf Echtzeitbedingungen an
- **Regel-Engine-Integration**: Implementieren Sie komplexe GeschÃ¤ftsregel-Engines innerhalb von Workflows

### ğŸ¢ **Bedingte Anwendungen im Unternehmen**
- **Dokumentenklassifikation und -routing**: Klassifizieren und leiten Sie Dokumente automatisch zu den entsprechenden Workflows
- **Kundenservice-Triage**: Intelligentes Routing von Kundenanfragen an spezialisierte Teams
- **Compliance- und Risikoverarbeitung**: Wenden Sie unterschiedliche Validierungs- und ÃœberprÃ¼fungsprozesse basierend auf Risikobewertungen an
- **QualitÃ¤tssicherungs-Workflows**: Leiten Sie Inhalte basierend auf QualitÃ¤tsmetriken durch geeignete ÃœberprÃ¼fungsprozesse

## âš™ï¸ Voraussetzungen & Einrichtung

### ğŸ“¦ **Erforderliche NuGet-Pakete**

Erweiterte Pakete fÃ¼r bedingte Workflow-Verarbeitung:

```xml
<!-- Core AI Framework -->
<PackageReference Include="Microsoft.Extensions.AI" Version="9.9.0" />

<!-- Azure AI Agents with Persistent State -->
<PackageReference Include="Azure.AI.Agents.Persistent" Version="1.2.0-beta.5" />

<!-- Azure Identity and Utilities -->
<PackageReference Include="Azure.Identity" Version="1.15.0" />
<PackageReference Include="System.Linq.Async" Version="6.0.3" />
<PackageReference Include="DotNetEnv" Version="3.1.1" />

<!-- Local Workflow Framework References -->
<!-- Microsoft.Agents.Workflows.dll - Advanced workflow orchestration -->
<!-- Microsoft.Agents.AI.AzureAI.dll - Azure AI Foundry integration -->
<!-- Microsoft.Agents.AI.dll - Core agent abstractions -->
```

### ğŸ”‘ **Azure AI Foundry-Konfiguration**

**Erforderliche Azure-Ressourcen:**
- Azure AI Foundry-Arbeitsbereich mit Modellen fÃ¼r bedingte Verarbeitung
- Azure-Abonnement mit entsprechenden Compute-Kontingenten und Berechtigungen
- Bereitgestellte KI-Modelle fÃ¼r Entscheidungsfindung und Inhaltsanalyse
- (Optional) Bing Search API-Verbindung fÃ¼r Grounding-Funktionen

**Umgebungskonfiguration (.env-Datei):**
```env
# Azure AI Foundry Configuration
AZURE_AI_PROJECT_ENDPOINT=https://your-project.cognitiveservices.azure.com/
BING_CONNECTION_ID=your-bing-connection-id
```

**Authentifizierungseinrichtung:**
```csharp
// Azure CLI or Managed Identity authentication
using Azure.Identity;
var credential = new AzureCliCredential();

// Load environment configuration
DotNetEnv.Env.Load("../../../.env");
```

### ğŸ—ï¸ **Architektur fÃ¼r bedingte Workflows**

```mermaid
graph TD
    A[Input: Content Outline] --> B[Draft Executor]
    B --> C[Content Review Executor]
    C --> D{Review Decision}
    
    D -->|Yes - Approved| E[Publish Executor]
    D -->|No - Rejected| F[Send Review Executor]
    
    E --> G[Save as Markdown File]
    F --> H[Notify for Revisions]
    
    I[Azure AI Foundry] --> B
    I --> C
    I --> E
    
    J[Bing Grounding] --> B
```

**Wichtige Komponenten:**
- **Draft Executor**: KI-Agent, der erste InhaltsentwÃ¼rfe aus Gliederungen erstellt
- **Content Review Executor**: KI-Agent, der die QualitÃ¤t und Compliance von EntwÃ¼rfen bewertet
- **Bedingtes Routing**: Entscheidungslogik, die basierend auf ÃœberprÃ¼fungsergebnissen steuert
- **VerÃ¶ffentlichungs-/ÃœberprÃ¼fungspfade**: Separate Verarbeitungswege fÃ¼r genehmigte vs. abgelehnte Inhalte
- **Zustandsverwaltung**: Beibehaltung des Inhalts- und ÃœberprÃ¼fungskontexts wÃ¤hrend des Workflows

## ğŸ¨ **Designmuster fÃ¼r bedingte Workflows**

### ğŸ“‹ **Inhaltsproduktion mit QualitÃ¤tskontrollen**
```
Outline â†’ Draft Creation â†’ Quality Review â†’ {Approve: Publish | Reject: Revise}
```

### ğŸ¯ **Risikobasierte Dokumentenverarbeitung**
```
Document â†’ Risk Assessment â†’ {Low: Standard | High: Enhanced Review}
```

### ğŸ” **Intelligentes Kundenservice-Routing**
```
Customer Query â†’ Analysis â†’ {Simple: FAQ Bot | Complex: Human Agent}
```

### ğŸ’¼ **Compliance-gesteuerte Workflows**
```
Content â†’ Compliance Check â†’ {Pass: Publish | Fail: Legal Review}
```

## ğŸ¢ **Vorteile bedingter Workflows im Unternehmen**

### ğŸ¯ **Intelligente Automatisierung**
- **Intelligente Entscheidungsfindung**: KI-gesteuerte Routing-Entscheidungen basierend auf Inhaltsanalyse und Kontext
- **Adaptive Verarbeitung**: Workflows, die sich automatisch an sich Ã¤ndernde Bedingungen anpassen
- **Durchsetzung von GeschÃ¤ftsregeln**: Automatische Anwendung komplexer GeschÃ¤ftslogik und Richtlinien
- **Kontextbewusstes Routing**: Entscheidungen basierend auf vollstÃ¤ndiger Workflow-Historie und angesammeltem Kontext

### ğŸ“ˆ **Betriebliche Exzellenz**
- **Optimierte Ressourcenzuweisung**: Leiten Sie Arbeit an die am besten geeigneten Spezialisten und Prozesse weiter
- **Reduzierter manueller Eingriff**: Automatisierte Entscheidungsfindung minimiert den Bedarf an menschlichem Routing
- **Schnellere Bearbeitungszeiten**: Direkte Weiterleitung an geeignete Fachkenntnisse und VerarbeitungskapazitÃ¤ten
- **Einheitliche Anwendung**: Einheitliche Anwendung von GeschÃ¤ftsregeln und Entscheidungskriterien

### ğŸ›¡ï¸ **Risikomanagement & Compliance**
- **Automatisierte Risikobewertung**: KI-gesteuerte Bewertung von Inhalts- und Situationsrisiken
- **Durchsetzung von Compliance**: Automatisches Routing durch erforderliche regulatorische Prozesse
- **Anwendung von Sicherheitsprotokollen**: Verbesserte SicherheitsmaÃŸnahmen basierend auf Risikobewertungen
- **Wartung von Audit-Trails**: VollstÃ¤ndige Dokumentation von Routing-Entscheidungen und deren BegrÃ¼ndung

### ğŸ“Š **Analytik & kontinuierliche Verbesserung**
- **Entscheidungsanalytik**: Verfolgen Sie die EffektivitÃ¤t und Genauigkeit von Routing-Entscheidungen
- **Mustererkennung**: Identifizieren Sie Trends und Muster in Routing-Entscheidungen im Laufe der Zeit
- **Leistungsoptimierung**: Kontinuierliche Verbesserung der Entscheidungskriterien und Routing-Effizienz
- **Business Intelligence**: Erkenntnisse zu Inhaltsmerkmalen und Verarbeitungsanforderungen

### ğŸ”§ **Technische Exzellenz**
- **Persistente Zustandsverwaltung**: Behalten Sie komplexe ZustÃ¤nde wÃ¤hrend der Workflow-AusfÃ¼hrung bei
- **Skalierbare Architektur**: BewÃ¤ltigen Sie Anforderungen an die bedingte Verarbeitung bei hohem Volumen
- **IntegrationsfÃ¤higkeiten**: Nahtlose Integration in bestehende GeschÃ¤ftssysteme und -prozesse
- **Ãœberwachung & Beobachtbarkeit**: Umfassende Verfolgung der Workflow-Leistung und Entscheidungen

Lassen Sie uns intelligente, entscheidungsgetriebene Unternehmens-Workflows mit .NET erstellen! ğŸš€

## ğŸ’» Code ausfÃ¼hren

Die vollstÃ¤ndige Implementierung ist verfÃ¼gbar in `04.dotnet-agent-framework-workflow-aifoundry-condition.cs`. Dies demonstriert einen **Inhaltsproduktions-Workflow mit QualitÃ¤tskontrollen**:

### ğŸ—ï¸ **Workflow-Architektur**

```
Content Outline â†’ Draft Creation â†’ Quality Review â†’ Conditional Routing:
                                                      â”œâ”€ Approved (>200 words) â†’ Publish
                                                      â””â”€ Rejected (<200 words) â†’ Review Notification
```

**Agenten im Workflow:**
1. **Evangelist Agent**: Erstellt Tutorial-EntwÃ¼rfe aus Gliederungen mit Bing-Grounding
2. **Content Reviewer Agent**: Bewertet die QualitÃ¤t des Entwurfs (Wortanzahl, VollstÃ¤ndigkeit)
3. **Publisher Agent**: Speichert genehmigte Inhalte als Markdown-Dateien mit Zeitstempel

**Benutzerdefinierte Executor:**
1. **DraftExecutor**: Koordiniert die Erstellung von EntwÃ¼rfen
2. **ContentReviewExecutor**: FÃ¼hrt QualitÃ¤tsbewertungen durch
3. **PublishExecutor**: VerÃ¶ffentlicht genehmigte Inhalte
4. **SendReviewExecutor**: Verwalten von Benachrichtigungen bei abgelehnten Inhalten

### ğŸš€ Beispiel ausfÃ¼hren

**Voraussetzungen:**
- Konfigurierter Azure AI Foundry-Arbeitsbereich
- Azure CLI-Authentifizierung (`az login`)
- (Optional) Bing Search-Verbindung fÃ¼r Grounding

```bash
# Make the script executable (Unix/Linux/macOS)
chmod +x 04.dotnet-agent-framework-workflow-aifoundry-condition.cs

# Run the conditional workflow
./04.dotnet-agent-framework-workflow-aifoundry-condition.cs
```

Oder unter Windows:
```powershell
dotnet run 04.dotnet-agent-framework-workflow-aifoundry-condition.cs
```

### ğŸ“ Erwartete Ausgabe

Der Workflow wird:
1. **Agenten erstellen**: Drei spezialisierte Azure AI Foundry-Agenten initialisieren
2. **Entwurf erstellen**: Evangelist Agent erstellt Tutorial-Entwurf aus Gliederung
3. **Inhalt Ã¼berprÃ¼fen**: Content Reviewer bewertet die QualitÃ¤t des Entwurfs
4. **Bedingtes Routing**:
   - **Wenn genehmigt (>200 WÃ¶rter)**: Publish Executor speichert als Markdown-Datei
   - **Wenn abgelehnt (<200 WÃ¶rter)**: Send Review Executor sendet Benachrichtigung
5. **Ergebnisse anzeigen**: Zeigt das endgÃ¼ltige Workflow-Ergebnis an

### ğŸ”§ Anpassungsoptionen

**ÃœberprÃ¼fungskriterien Ã¤ndern:**
```csharp
const string ContentReviewerInstructions = @"
You are a content reviewer...
1. Check if content is more than 500 words (instead of 200)
2. Verify technical accuracy
3. Ensure proper formatting
...";
```

**Weitere bedingte Pfade hinzufÃ¼gen:**
```csharp
var workflow = new WorkflowBuilder(draftExecutor)
    .AddEdge(draftExecutor, contentReviewerExecutor)
    .AddEdge(contentReviewerExecutor, publishExecutor, condition: GetCondition("Excellent"))
    .AddEdge(contentReviewerExecutor, editExecutor, condition: GetCondition("Good"))
    .AddEdge(contentReviewerExecutor, sendReviewerExecutor, condition: GetCondition("Poor"))
    .Build();
```

**Inhaltsanforderungen Ã¤ndern:**
```csharp
string OUTLINE_Content = @"
# Your Custom Topic
## Section 1
https://your-reference-url
## Section 2
...
";
```

### ğŸ¯ Anwendungen in der Praxis

Dieses bedingte Workflow-Muster eignet sich ideal fÃ¼r:
- **Content-Management-Systeme**: Automatisierte redaktionelle Workflows mit QualitÃ¤tskontrollen
- **Dokumentenverarbeitung**: Dokumente basierend auf Klassifikation und Compliance routen
- **Kundensupport**: Intelligentes Ticket-Routing basierend auf KomplexitÃ¤t und Dringlichkeit
- **RechtsprÃ¼fung**: VertrÃ¤ge basierend auf Risikobewertung und Wert routen
- **HR-Prozesse**: Bewerbungen durch geeignete Screening-Workflows leiten

### ğŸ” VerstÃ¤ndnis der bedingten Logik

**Bedingungsfunktion:**
```csharp
public Func<object?, bool> GetCondition(string expectedResult) =>
    reviewResult => reviewResult is ReviewResult review && review.Result == expectedResult;
```

Diese Funktion erstellt ein PrÃ¤dikat, das:
1. ÃœberprÃ¼ft, ob das Ergebnis vom Typ `ReviewResult` ist
2. Die Eigenschaft `Result` mit dem erwarteten Wert vergleicht
3. True/False zurÃ¼ckgibt, um das Routing zu bestimmen

**Workflow-Kanten mit Bedingungen:**
```csharp
.AddEdge(contentReviewerExecutor, publishExecutor, condition: GetCondition("Yes"))
.AddEdge(contentReviewerExecutor, sendReviewerExecutor, condition: GetCondition("No"))
```

### ğŸ“Š Erweiterte Funktionen

**JSON-Schema-Validierung:**
Der Workflow verwendet JSON-Schemas, um strukturierte Antworten sicherzustellen:

```csharp
// Define response structure
public class ReviewResult
{
    [JsonPropertyName("review_result")]
    public string Result { get; set; } = string.Empty;
    
    [JsonPropertyName("reason")]
    public string Reason { get; set; } = string.Empty;
    
    [JsonPropertyName("draft_content")]
    public string DraftContent { get; set; } = string.Empty;
}

// Apply to agent
ResponseFormat = ChatResponseFormat.ForJsonSchema(
    AIJsonUtilities.CreateJsonSchema(typeof(ReviewResult)), 
    "ReviewResult", 
    "Review Result From DraftContent"
)
```

**Bing-Grounding-Integration:**
Der Evangelist Agent nutzt Bing-Grounding, um auf Echtzeitinformationen zuzugreifen:

```csharp
var bingGroundingConfig = new BingGroundingSearchConfiguration(bing_conn_id);
BingGroundingToolDefinition bingGroundingTool = new(
    new BingGroundingSearchToolParameters([bingGroundingConfig])
);
```

Dies ermÃ¶glicht es dem Agenten, URLs in der Gliederung zu folgen und aktuelle Informationen zu extrahieren.

### ğŸ›¡ï¸ Fehlerbehandlung

Der Workflow enthÃ¤lt robuste Fehlerbehandlungsmechanismen fÃ¼r abgelehnte Inhalte:
- ÃœberprÃ¼fungsfehler lÃ¶sen den alternativen Pfad aus
- Benachrichtigungen bieten klare AblehnungsgrÃ¼nde
- Inhalte werden fÃ¼r Ãœberarbeitungen erhalten

### ğŸ”„ Erweiterung des Workflows

**Feedback-Schleife hinzufÃ¼gen:**
Erstellen Sie eine Feedback-Schleife, die Inhalte automatisch neu entwirft:

```csharp
.AddEdge(contentReviewerExecutor, publishExecutor, condition: GetCondition("Yes"))
.AddEdge(contentReviewerExecutor, draftExecutor, condition: GetCondition("No")) // Loop back
```

**Mehrstufige ÃœberprÃ¼fung implementieren:**
FÃ¼gen Sie mehrere ÃœberprÃ¼fungsstufen mit unterschiedlichen Kriterien hinzu:

```csharp
.AddEdge(draftExecutor, technicalReviewer)
.AddEdge(technicalReviewer, editorialReviewer, condition: GetCondition("TechPass"))
.AddEdge(editorialReviewer, publishExecutor, condition: GetCondition("EditPass"))
```

Dieses bedingte Workflow-Muster bietet die Grundlage fÃ¼r den Aufbau komplexer, intelligenter Automatisierungssysteme fÃ¼r Unternehmen! ğŸš€

---

<!-- CO-OP TRANSLATOR DISCLAIMER START -->
**Haftungsausschluss**:  
Dieses Dokument wurde mit dem KI-Ãœbersetzungsdienst [Co-op Translator](https://github.com/Azure/co-op-translator) Ã¼bersetzt. Obwohl wir uns um Genauigkeit bemÃ¼hen, beachten Sie bitte, dass automatisierte Ãœbersetzungen Fehler oder Ungenauigkeiten enthalten kÃ¶nnen. Das Originaldokument in seiner ursprÃ¼nglichen Sprache sollte als maÃŸgebliche Quelle betrachtet werden. FÃ¼r kritische Informationen wird eine professionelle menschliche Ãœbersetzung empfohlen. Wir Ã¼bernehmen keine Haftung fÃ¼r MissverstÃ¤ndnisse oder Fehlinterpretationen, die sich aus der Nutzung dieser Ãœbersetzung ergeben.
<!-- CO-OP TRANSLATOR DISCLAIMER END -->