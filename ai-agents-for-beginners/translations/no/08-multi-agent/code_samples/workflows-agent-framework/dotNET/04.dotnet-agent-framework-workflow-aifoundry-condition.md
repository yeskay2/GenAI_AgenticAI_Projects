<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "8abd335151cee553293b637ee3d80d10",
  "translation_date": "2025-11-11T12:19:52+00:00",
  "source_file": "08-multi-agent/code_samples/workflows-agent-framework/dotNET/04.dotnet-agent-framework-workflow-aifoundry-condition.md",
  "language_code": "no"
}
-->
# ğŸ”€ Betingede Agentarbeidsflyter med Azure AI Foundry (.NET)

## ğŸ“‹ Veiledning for Intelligent Beslutningsbasert Arbeidsflyt

Denne notatboken demonstrerer **betingede arbeidsflytmÃ¸nstre** ved bruk av Azure AI Foundry og Microsoft Agent Framework for .NET. Du vil lÃ¦re hvordan du bygger avanserte, beslutningsdrevne arbeidsflyter som intelligent styrer prosessering basert pÃ¥ AI-analyse, forretningsregler og dynamiske betingelser for automatisering pÃ¥ bedriftsnivÃ¥.

## ğŸ¯ LÃ¦ringsmÃ¥l

### ğŸ§  **Intelligent Beslutningsarkitektur**
- **Implementering av betinget logikk**: Bygg komplekse beslutningstrÃ¦r med flere forgreningspunkter
- **AI-drevet ruting**: Bruk Azure AI Foundry-modeller for Ã¥ ta intelligente rutingsbeslutninger
- **Dynamisk tilpasning av arbeidsflyt**: Endre arbeidsflytens oppfÃ¸rsel basert pÃ¥ analyse og betingelser under kjÃ¸ring
- **Integrering av forretningsregler**: Inkluder forretningslogikk og samsvarskrav i arbeidsflyter

### ğŸ”€ **Avanserte betingede mÃ¸nstre**
- **Beslutningstaking basert pÃ¥ flere kriterier**: Vurder flere faktorer for rutingsbeslutninger
- **Kontekstbevisst prosessering**: Ta beslutninger basert pÃ¥ akkumulert arbeidsflytkontekst og historikk
- **Tilpasning av arbeidsflyt**: Juster prosesseringsveier dynamisk basert pÃ¥ sanntidsbetingelser
- **Integrering av regelmotor**: Implementer avanserte forretningsregelmotorer i arbeidsflyter

### ğŸ¢ **Betingede applikasjoner for bedrifter**
- **Dokumentklassifisering og ruting**: Klassifiser og ruter dokumenter automatisk til passende arbeidsflyter
- **Kundebehandling**: Intelligent ruting av kundehenvendelser til spesialiserte team
- **Samsvar og risikohÃ¥ndtering**: Bruk ulike validerings- og gjennomgangsprosesser basert pÃ¥ risikovurdering
- **Kvalitetssikringsarbeidsflyter**: Ruter innhold gjennom passende gjennomgangsprosesser basert pÃ¥ kvalitetsmÃ¥linger

## âš™ï¸ Forutsetninger og oppsett

### ğŸ“¦ **NÃ¸dvendige NuGet-pakker**

Avanserte pakker for betinget arbeidsflytprosessering:

```xml
<!-- Core AI Framework -->
<PackageReference Include="Microsoft.Extensions.AI" Version="9.9.0" />

<!-- Azure AI Agents with Persistent State -->
<PackageReference Include="Azure.AI.Agents.Persistent" Version="1.2.0-beta.5" />

<!-- Azure Identity and Utilities -->
<PackageReference Include="Azure.Identity" Version="1.15.0" />
<PackageReference Include="System.Linq.Async" Version="6.0.3" />
<PackageReference Include="DotNetEnv" Version="3.1.1" />

<!-- Local Workflow Framework References -->
<!-- Microsoft.Agents.Workflows.dll - Advanced workflow orchestration -->
<!-- Microsoft.Agents.AI.AzureAI.dll - Azure AI Foundry integration -->
<!-- Microsoft.Agents.AI.dll - Core agent abstractions -->
```

### ğŸ”‘ **Azure AI Foundry-konfigurasjon**

**NÃ¸dvendige Azure-ressurser:**
- Azure AI Foundry-arbeidsomrÃ¥de med modeller for betinget prosessering
- Azure-abonnement med passende datakvoter og tillatelser
- Distribuerte AI-modeller for beslutningstaking og innholdsanalyse
- (Valgfritt) Bing Search API-tilkobling for grunnleggende funksjoner

**MiljÃ¸konfigurasjon (.env-fil):**
```env
# Azure AI Foundry Configuration
AZURE_AI_PROJECT_ENDPOINT=https://your-project.cognitiveservices.azure.com/
BING_CONNECTION_ID=your-bing-connection-id
```

**Autentiseringsoppsett:**
```csharp
// Azure CLI or Managed Identity authentication
using Azure.Identity;
var credential = new AzureCliCredential();

// Load environment configuration
DotNetEnv.Env.Load("../../../.env");
```

### ğŸ—ï¸ **Arkitektur for betinget arbeidsflyt**

```mermaid
graph TD
    A[Input: Content Outline] --> B[Draft Executor]
    B --> C[Content Review Executor]
    C --> D{Review Decision}
    
    D -->|Yes - Approved| E[Publish Executor]
    D -->|No - Rejected| F[Send Review Executor]
    
    E --> G[Save as Markdown File]
    F --> H[Notify for Revisions]
    
    I[Azure AI Foundry] --> B
    I --> C
    I --> E
    
    J[Bing Grounding] --> B
```

**NÃ¸kkelkomponenter:**
- **Draft Executor**: AI-agent som lager innledende innholdskladder fra disposisjoner
- **Content Review Executor**: AI-agent som evaluerer kvalitet og samsvar for kladdene
- **Betinget ruting**: Beslutningslogikk som ruter basert pÃ¥ gjennomgangsresultater
- **Publiserings-/gjennomgangsveier**: Separate prosesseringsveier for godkjent vs. avvist innhold
- **Tilstandsadministrasjon**: Opprettholder innhold og gjennomgangskontekst gjennom hele arbeidsflyten

## ğŸ¨ **DesignmÃ¸nstre for betinget arbeidsflyt**

### ğŸ“‹ **Innholdsproduksjon med kvalitetsporter**
```
Outline â†’ Draft Creation â†’ Quality Review â†’ {Approve: Publish | Reject: Revise}
```

### ğŸ¯ **Risikobasert dokumentprosessering**
```
Document â†’ Risk Assessment â†’ {Low: Standard | High: Enhanced Review}
```

### ğŸ” **Intelligent kundeserviceruting**
```
Customer Query â†’ Analysis â†’ {Simple: FAQ Bot | Complex: Human Agent}
```

### ğŸ’¼ **Samsvarsbaserte arbeidsflyter**
```
Content â†’ Compliance Check â†’ {Pass: Publish | Fail: Legal Review}
```

## ğŸ¢ **Fordeler med betinget arbeidsflyt for bedrifter**

### ğŸ¯ **Intelligent automatisering**
- **Smarte beslutninger**: AI-drevne rutingsbeslutninger basert pÃ¥ innholdsanalyse og kontekst
- **Tilpasset prosessering**: Arbeidsflyter som automatisk justeres basert pÃ¥ endrede betingelser
- **HÃ¥ndheving av forretningsregler**: Automatisk anvendelse av komplekse forretningslogikker og retningslinjer
- **Kontekstbevisst ruting**: Beslutninger basert pÃ¥ full arbeidsflythistorikk og akkumulert kontekst

### ğŸ“ˆ **Operasjonell fortreffelighet**
- **Optimal ressursallokering**: Ruter arbeid til de mest passende spesialistene og prosessene
- **Redusert manuell intervensjon**: Automatisert beslutningstaking minimerer behovet for menneskelig ruting
- **Raskere lÃ¸sningstider**: Direkte ruting til passende ekspertise og prosesseringskapasiteter
- **Konsekvent anvendelse**: Ensartet anvendelse av forretningsregler og beslutningskriterier

### ğŸ›¡ï¸ **RisikohÃ¥ndtering og samsvar**
- **Automatisk risikovurdering**: AI-drevet evaluering av innhold og situasjonsrisikonivÃ¥er
- **SamsvarshÃ¥ndheving**: Automatisk ruting gjennom nÃ¸dvendige regulatoriske prosesser
- **Anvendelse av sikkerhetsprotokoller**: Forsterkede sikkerhetstiltak basert pÃ¥ risikovurdering
- **Vedlikehold av revisjonsspor**: Full dokumentasjon av rutingsbeslutninger og begrunnelser

### ğŸ“Š **Analyse og kontinuerlig forbedring**
- **Beslutningsanalyse**: Spor effektiviteten og nÃ¸yaktigheten til rutingsbeslutninger
- **MÃ¸nsteridentifikasjon**: Identifiser trender og mÃ¸nstre i rutingsbeslutninger over tid
- **Optimalisering av ytelse**: Kontinuerlig forbedring av beslutningskriterier og rutingseffektivitet
- **Forretningsinnsikt**: Innsikt i innholdskarakteristikker og prosesseringsbehov

### ğŸ”§ **Teknisk fortreffelighet**
- **Vedvarende tilstandsadministrasjon**: Oppretthold kompleks tilstand gjennom arbeidsflytutfÃ¸relse
- **Skalerbar arkitektur**: HÃ¥ndter hÃ¸ye volum av betinget prosessering
- **Integreringsmuligheter**: SÃ¸mlÃ¸s integrering med eksisterende forretningssystemer og prosesser
- **OvervÃ¥king og observasjon**: Omfattende sporing av arbeidsflytytelse og beslutninger

La oss bygge intelligente, beslutningsdrevne arbeidsflyter for bedrifter med .NET! ğŸš€

## ğŸ’» KjÃ¸re koden

Den komplette implementeringen er tilgjengelig i `04.dotnet-agent-framework-workflow-aifoundry-condition.cs`. Dette demonstrerer en **innholdsproduksjonsarbeidsflyt med kvalitetsporter**:

### ğŸ—ï¸ **Arbeidsflytarkitektur**

```
Content Outline â†’ Draft Creation â†’ Quality Review â†’ Conditional Routing:
                                                      â”œâ”€ Approved (>200 words) â†’ Publish
                                                      â””â”€ Rejected (<200 words) â†’ Review Notification
```

**Agenter i arbeidsflyten:**
1. **Evangelist Agent**: Lager opplÃ¦ringskladd fra disposisjoner med Bing-grunnlag
2. **Content Reviewer Agent**: Evaluerer kladdkvalitet (ordtelling, fullstendighet)
3. **Publisher Agent**: Lagre godkjent innhold som tidsstemplet Markdown-fil

**Egendefinerte utfÃ¸rere:**
1. **DraftExecutor**: Orkestrerer kladdoppretting
2. **ContentReviewExecutor**: UtfÃ¸rer kvalitetsvurdering
3. **PublishExecutor**: HÃ¥ndterer publisering av godkjent innhold
4. **SendReviewExecutor**: Administrerer varsler om avvist innhold

### ğŸš€ KjÃ¸re eksempelet

**Forutsetninger:**
- Konfigurert Azure AI Foundry-arbeidsomrÃ¥de
- Azure CLI-autentisering (`az login`)
- (Valgfritt) Bing Search-tilkobling for grunnlag

```bash
# Make the script executable (Unix/Linux/macOS)
chmod +x 04.dotnet-agent-framework-workflow-aifoundry-condition.cs

# Run the conditional workflow
./04.dotnet-agent-framework-workflow-aifoundry-condition.cs
```

Eller pÃ¥ Windows:
```powershell
dotnet run 04.dotnet-agent-framework-workflow-aifoundry-condition.cs
```

### ğŸ“ Forventet resultat

Arbeidsflyten vil:
1. **Opprette agenter**: Initialisere tre spesialiserte Azure AI Foundry-agenter
2. **Generere kladd**: Evangelist-agent lager opplÃ¦ringskladd fra disposisjon
3. **GjennomgÃ¥ innhold**: Content Reviewer evaluerer kladdkvalitet
4. **Betinget ruting**:
   - **Hvis godkjent (>200 ord)**: Publish Executor lagrer som Markdown-fil
   - **Hvis avvist (<200 ord)**: Send Review Notification
5. **Vis resultater**: Vise endelig arbeidsflytresultat

### ğŸ”§ Tilpasningsmuligheter

**Endre gjennomgangskriterier:**
```csharp
const string ContentReviewerInstructions = @"
You are a content reviewer...
1. Check if content is more than 500 words (instead of 200)
2. Verify technical accuracy
3. Ensure proper formatting
...";
```

**Legg til flere betingede veier:**
```csharp
var workflow = new WorkflowBuilder(draftExecutor)
    .AddEdge(draftExecutor, contentReviewerExecutor)
    .AddEdge(contentReviewerExecutor, publishExecutor, condition: GetCondition("Excellent"))
    .AddEdge(contentReviewerExecutor, editExecutor, condition: GetCondition("Good"))
    .AddEdge(contentReviewerExecutor, sendReviewerExecutor, condition: GetCondition("Poor"))
    .Build();
```

**Endre innholdskrav:**
```csharp
string OUTLINE_Content = @"
# Your Custom Topic
## Section 1
https://your-reference-url
## Section 2
...
";
```

### ğŸ¯ Virkelige applikasjoner

Dette mÃ¸nsteret for betinget arbeidsflyt er ideelt for:
- **Innholdsadministrasjonssystemer**: Automatiserte redaksjonelle arbeidsflyter med kvalitetsporter
- **Dokumentprosessering**: Ruter dokumenter basert pÃ¥ klassifisering og samsvar
- **KundestÃ¸tte**: Intelligent ruting av billetter basert pÃ¥ kompleksitet og hast
- **Juridisk gjennomgang**: Ruter kontrakter basert pÃ¥ risikovurdering og verdi
- **HR-prosesser**: Ruter sÃ¸knader gjennom passende screeningarbeidsflyter

### ğŸ” ForstÃ¥ betinget logikk

**Betingelsesfunksjon:**
```csharp
public Func<object?, bool> GetCondition(string expectedResult) =>
    reviewResult => reviewResult is ReviewResult review && review.Result == expectedResult;
```

Denne funksjonen oppretter en predikat som:
1. Sjekker om resultatet er av typen `ReviewResult`
2. Sammenligner `Result`-egenskapen med forventet verdi
3. Returnerer sann/falsk for Ã¥ avgjÃ¸re ruting

**Arbeidsflytkanter med betingelser:**
```csharp
.AddEdge(contentReviewerExecutor, publishExecutor, condition: GetCondition("Yes"))
.AddEdge(contentReviewerExecutor, sendReviewerExecutor, condition: GetCondition("No"))
```

### ğŸ“Š Avanserte funksjoner

**JSON-skjema validering:**
Arbeidsflyten bruker JSON-skjemaer for Ã¥ sikre strukturerte svar:

```csharp
// Define response structure
public class ReviewResult
{
    [JsonPropertyName("review_result")]
    public string Result { get; set; } = string.Empty;
    
    [JsonPropertyName("reason")]
    public string Reason { get; set; } = string.Empty;
    
    [JsonPropertyName("draft_content")]
    public string DraftContent { get; set; } = string.Empty;
}

// Apply to agent
ResponseFormat = ChatResponseFormat.ForJsonSchema(
    AIJsonUtilities.CreateJsonSchema(typeof(ReviewResult)), 
    "ReviewResult", 
    "Review Result From DraftContent"
)
```

**Bing-grunnlagsintegrasjon:**
Evangelist-agenten bruker Bing-grunnlag for Ã¥ fÃ¥ tilgang til sanntidsinformasjon:

```csharp
var bingGroundingConfig = new BingGroundingSearchConfiguration(bing_conn_id);
BingGroundingToolDefinition bingGroundingTool = new(
    new BingGroundingSearchToolParameters([bingGroundingConfig])
);
```

Dette gjÃ¸r det mulig for agenten Ã¥ fÃ¸lge URL-er i disposisjonen og hente oppdatert informasjon.

### ğŸ›¡ï¸ FeilhÃ¥ndtering

Arbeidsflyten inkluderer robust feilhÃ¥ndtering for avvist innhold:
- Gjennomgangsfeil utlÃ¸ser den alternative veien
- Varsler gir klare avvisningsÃ¥rsaker
- Innhold bevares for revisjon

### ğŸ”„ Utvidelse av arbeidsflyten

**Legg til en revisjonsloop:**
Opprett en tilbakemeldingsslÃ¸yfe som automatisk lager innhold pÃ¥ nytt:

```csharp
.AddEdge(contentReviewerExecutor, publishExecutor, condition: GetCondition("Yes"))
.AddEdge(contentReviewerExecutor, draftExecutor, condition: GetCondition("No")) // Loop back
```

**Implementer flernivÃ¥gjennomgang:**
Legg til flere gjennomgangsstadier med ulike kriterier:

```csharp
.AddEdge(draftExecutor, technicalReviewer)
.AddEdge(technicalReviewer, editorialReviewer, condition: GetCondition("TechPass"))
.AddEdge(editorialReviewer, publishExecutor, condition: GetCondition("EditPass"))
```

Dette mÃ¸nsteret for betinget arbeidsflyt gir grunnlaget for Ã¥ bygge sofistikerte, intelligente automatiseringssystemer for bedrifter! ğŸš€

---

<!-- CO-OP TRANSLATOR DISCLAIMER START -->
**Ansvarsfraskrivelse**:  
Dette dokumentet er oversatt ved hjelp av AI-oversettelsestjenesten [Co-op Translator](https://github.com/Azure/co-op-translator). Selv om vi streber etter nÃ¸yaktighet, vÃ¦r oppmerksom pÃ¥ at automatiserte oversettelser kan inneholde feil eller unÃ¸yaktigheter. Det originale dokumentet pÃ¥ dets opprinnelige sprÃ¥k bÃ¸r anses som den autoritative kilden. For kritisk informasjon anbefales profesjonell menneskelig oversettelse. Vi er ikke ansvarlige for eventuelle misforstÃ¥elser eller feiltolkninger som oppstÃ¥r ved bruk av denne oversettelsen.
<!-- CO-OP TRANSLATOR DISCLAIMER END -->