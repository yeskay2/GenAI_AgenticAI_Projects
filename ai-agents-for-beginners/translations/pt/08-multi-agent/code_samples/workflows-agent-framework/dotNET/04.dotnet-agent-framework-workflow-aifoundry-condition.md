<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "8abd335151cee553293b637ee3d80d10",
  "translation_date": "2025-11-11T12:12:53+00:00",
  "source_file": "08-multi-agent/code_samples/workflows-agent-framework/dotNET/04.dotnet-agent-framework-workflow-aifoundry-condition.md",
  "language_code": "pt"
}
-->
# üîÄ Fluxos de Trabalho Condicionais com Azure AI Foundry (.NET)

## üìã Tutorial de Fluxo de Trabalho Baseado em Decis√µes Inteligentes

Este notebook demonstra **padr√µes de fluxo de trabalho condicionais** usando Azure AI Foundry e o Microsoft Agent Framework para .NET. Aprender√° a construir fluxos de trabalho sofisticados, orientados por decis√µes, que encaminham o processamento de forma inteligente com base em an√°lises de IA, regras de neg√≥cio e condi√ß√µes din√¢micas para automa√ß√£o de n√≠vel empresarial.

## üéØ Objetivos de Aprendizagem

### üß† **Arquitetura de Decis√£o Inteligente**
- **Implementa√ß√£o de L√≥gica Condicional**: Construir √°rvores de decis√£o complexas com m√∫ltiplos pontos de ramifica√ß√£o
- **Encaminhamento Inteligente com IA**: Utilizar modelos do Azure AI Foundry para tomar decis√µes de encaminhamento inteligentes
- **Adapta√ß√£o Din√¢mica do Fluxo de Trabalho**: Modificar o comportamento do fluxo de trabalho com base em an√°lises e condi√ß√µes em tempo de execu√ß√£o
- **Integra√ß√£o de Regras Empresariais**: Incorporar l√≥gica de neg√≥cios e requisitos de conformidade nos fluxos de trabalho

### üîÄ **Padr√µes Condicionais Avan√ßados**
- **Tomada de Decis√£o com M√∫ltiplos Crit√©rios**: Avaliar m√∫ltiplos fatores para decis√µes de encaminhamento
- **Processamento Contextual**: Tomar decis√µes com base no contexto acumulado e no hist√≥rico do fluxo de trabalho
- **Modifica√ß√£o Adaptativa do Fluxo de Trabalho**: Ajustar dinamicamente os caminhos de processamento com base em condi√ß√µes em tempo real
- **Integra√ß√£o de Motor de Regras**: Implementar motores de regras empresariais sofisticados nos fluxos de trabalho

### üè¢ **Aplica√ß√µes Condicionais Empresariais**
- **Classifica√ß√£o e Encaminhamento de Documentos**: Classificar e encaminhar documentos automaticamente para fluxos de trabalho apropriados
- **Triagem de Atendimento ao Cliente**: Encaminhamento inteligente de consultas de clientes para equipas especializadas
- **Processamento de Conformidade e Risco**: Aplicar diferentes processos de valida√ß√£o e revis√£o com base na avalia√ß√£o de risco
- **Fluxos de Trabalho de Garantia de Qualidade**: Encaminhar conte√∫do atrav√©s de processos de revis√£o apropriados com base em m√©tricas de qualidade

## ‚öôÔ∏è Pr√©-requisitos e Configura√ß√£o

### üì¶ **Pacotes NuGet Necess√°rios**

Pacotes avan√ßados para processamento de fluxos de trabalho condicionais:

```xml
<!-- Core AI Framework -->
<PackageReference Include="Microsoft.Extensions.AI" Version="9.9.0" />

<!-- Azure AI Agents with Persistent State -->
<PackageReference Include="Azure.AI.Agents.Persistent" Version="1.2.0-beta.5" />

<!-- Azure Identity and Utilities -->
<PackageReference Include="Azure.Identity" Version="1.15.0" />
<PackageReference Include="System.Linq.Async" Version="6.0.3" />
<PackageReference Include="DotNetEnv" Version="3.1.1" />

<!-- Local Workflow Framework References -->
<!-- Microsoft.Agents.Workflows.dll - Advanced workflow orchestration -->
<!-- Microsoft.Agents.AI.AzureAI.dll - Azure AI Foundry integration -->
<!-- Microsoft.Agents.AI.dll - Core agent abstractions -->
```

### üîë **Configura√ß√£o do Azure AI Foundry**

**Recursos Necess√°rios do Azure:**
- Espa√ßo de trabalho do Azure AI Foundry com modelos de processamento condicional
- Subscri√ß√£o do Azure com quotas de computa√ß√£o e permiss√µes adequadas
- Modelos de IA implantados para tomada de decis√£o e an√°lise de conte√∫do
- (Opcional) Conex√£o com a API de Pesquisa Bing para capacidades de grounding

**Configura√ß√£o do Ambiente (.env file):**
```env
# Azure AI Foundry Configuration
AZURE_AI_PROJECT_ENDPOINT=https://your-project.cognitiveservices.azure.com/
BING_CONNECTION_ID=your-bing-connection-id
```

**Configura√ß√£o de Autentica√ß√£o:**
```csharp
// Azure CLI or Managed Identity authentication
using Azure.Identity;
var credential = new AzureCliCredential();

// Load environment configuration
DotNetEnv.Env.Load("../../../.env");
```

### üèóÔ∏è **Arquitetura de Fluxo de Trabalho Condicional**

```mermaid
graph TD
    A[Input: Content Outline] --> B[Draft Executor]
    B --> C[Content Review Executor]
    C --> D{Review Decision}
    
    D -->|Yes - Approved| E[Publish Executor]
    D -->|No - Rejected| F[Send Review Executor]
    
    E --> G[Save as Markdown File]
    F --> H[Notify for Revisions]
    
    I[Azure AI Foundry] --> B
    I --> C
    I --> E
    
    J[Bing Grounding] --> B
```

**Componentes Principais:**
- **Draft Executor**: Agente de IA que cria rascunhos iniciais de conte√∫do a partir de esbo√ßos
- **Content Review Executor**: Agente de IA que avalia a qualidade e conformidade dos rascunhos
- **Encaminhamento Condicional**: L√≥gica de decis√£o que encaminha com base nos resultados da revis√£o
- **Caminhos de Publica√ß√£o/Revis√£o**: Caminhos de processamento separados para conte√∫do aprovado vs rejeitado
- **Gest√£o de Estado**: Mant√©m o contexto de conte√∫do e revis√£o ao longo do fluxo de trabalho

## üé® **Padr√µes de Design de Fluxo de Trabalho Condicional**

### üìã **Produ√ß√£o de Conte√∫do com Port√µes de Qualidade**
```
Outline ‚Üí Draft Creation ‚Üí Quality Review ‚Üí {Approve: Publish | Reject: Revise}
```

### üéØ **Processamento de Documentos Baseado em Risco**
```
Document ‚Üí Risk Assessment ‚Üí {Low: Standard | High: Enhanced Review}
```

### üîç **Encaminhamento Inteligente de Atendimento ao Cliente**
```
Customer Query ‚Üí Analysis ‚Üí {Simple: FAQ Bot | Complex: Human Agent}
```

### üíº **Fluxos de Trabalho Orientados por Conformidade**
```
Content ‚Üí Compliance Check ‚Üí {Pass: Publish | Fail: Legal Review}
```

## üè¢ **Benef√≠cios Condicionais Empresariais**

### üéØ **Automa√ß√£o Inteligente**
- **Tomada de Decis√£o Inteligente**: Decis√µes de encaminhamento orientadas por IA com base na an√°lise de conte√∫do e contexto
- **Processamento Adaptativo**: Fluxos de trabalho que se ajustam automaticamente com base em condi√ß√µes vari√°veis
- **Aplica√ß√£o de Regras Empresariais**: Aplica√ß√£o autom√°tica de l√≥gica de neg√≥cios e pol√≠ticas complexas
- **Encaminhamento Contextual**: Decis√µes baseadas no hist√≥rico completo do fluxo de trabalho e contexto acumulado

### üìà **Excel√™ncia Operacional**
- **Aloca√ß√£o Otimizada de Recursos**: Encaminhar trabalho para os especialistas e processos mais adequados
- **Redu√ß√£o de Interven√ß√£o Manual**: A tomada de decis√£o automatizada minimiza a necessidade de encaminhamento humano
- **Tempos de Resolu√ß√£o Mais R√°pidos**: Encaminhamento direto para capacidades de especializa√ß√£o e processamento apropriadas
- **Aplica√ß√£o Consistente**: Aplica√ß√£o uniforme de regras de neg√≥cios e crit√©rios de decis√£o

### üõ°Ô∏è **Gest√£o de Risco e Conformidade**
- **Avalia√ß√£o Autom√°tica de Risco**: Avalia√ß√£o orientada por IA dos n√≠veis de risco de conte√∫do e situa√ß√µes
- **Aplica√ß√£o de Conformidade**: Encaminhamento autom√°tico atrav√©s de processos regulat√≥rios necess√°rios
- **Aplica√ß√£o de Protocolos de Seguran√ßa**: Medidas de seguran√ßa aprimoradas aplicadas com base na avalia√ß√£o de risco
- **Manuten√ß√£o de Trilhas de Auditoria**: Documenta√ß√£o completa das decis√µes de encaminhamento e justificativas

### üìä **An√°lise e Melhoria Cont√≠nua**
- **An√°lise de Decis√µes**: Acompanhar a efic√°cia e precis√£o das decis√µes de encaminhamento
- **Reconhecimento de Padr√µes**: Identificar tend√™ncias e padr√µes nas decis√µes de encaminhamento ao longo do tempo
- **Otimiza√ß√£o de Desempenho**: Melhoria cont√≠nua dos crit√©rios de decis√£o e efici√™ncia de encaminhamento
- **Intelig√™ncia Empresarial**: Insights sobre caracter√≠sticas de conte√∫do e requisitos de processamento

### üîß **Excel√™ncia T√©cnica**
- **Gest√£o Persistente de Estado**: Manter estados complexos ao longo da execu√ß√£o do fluxo de trabalho
- **Arquitetura Escal√°vel**: Lidar com requisitos de processamento condicional de alto volume
- **Capacidades de Integra√ß√£o**: Integra√ß√£o perfeita com sistemas e processos empresariais existentes
- **Monitoriza√ß√£o e Observabilidade**: Rastreamento abrangente do desempenho e decis√µes do fluxo de trabalho

Vamos construir fluxos de trabalho empresariais inteligentes e orientados por decis√µes com .NET! üöÄ

## üíª Executando o C√≥digo

A implementa√ß√£o completa est√° dispon√≠vel em `04.dotnet-agent-framework-workflow-aifoundry-condition.cs`. Este demonstra um **fluxo de trabalho de produ√ß√£o de conte√∫do com port√µes de qualidade**:

### üèóÔ∏è **Arquitetura do Fluxo de Trabalho**

```
Content Outline ‚Üí Draft Creation ‚Üí Quality Review ‚Üí Conditional Routing:
                                                      ‚îú‚îÄ Approved (>200 words) ‚Üí Publish
                                                      ‚îî‚îÄ Rejected (<200 words) ‚Üí Review Notification
```

**Agentes no Fluxo de Trabalho:**
1. **Evangelist Agent**: Cria rascunhos de tutoriais a partir de esbo√ßos com grounding do Bing
2. **Content Reviewer Agent**: Avalia a qualidade do rascunho (contagem de palavras, completude)
3. **Publisher Agent**: Salva conte√∫do aprovado como ficheiros Markdown com carimbo de data/hora

**Executores Personalizados:**
1. **DraftExecutor**: Orquestra a cria√ß√£o de rascunhos
2. **ContentReviewExecutor**: Realiza avalia√ß√£o de qualidade
3. **PublishExecutor**: Lida com a publica√ß√£o de conte√∫do aprovado
4. **SendReviewExecutor**: Gerencia notifica√ß√µes de conte√∫do rejeitado

### üöÄ Executando o Exemplo

**Pr√©-requisitos:**
- Espa√ßo de trabalho do Azure AI Foundry configurado
- Autentica√ß√£o do Azure CLI (`az login`)
- (Opcional) Conex√£o com Pesquisa Bing para grounding

```bash
# Make the script executable (Unix/Linux/macOS)
chmod +x 04.dotnet-agent-framework-workflow-aifoundry-condition.cs

# Run the conditional workflow
./04.dotnet-agent-framework-workflow-aifoundry-condition.cs
```

Ou no Windows:
```powershell
dotnet run 04.dotnet-agent-framework-workflow-aifoundry-condition.cs
```

### üìù Resultado Esperado

O fluxo de trabalho ir√°:
1. **Criar Agentes**: Inicializar tr√™s agentes especializados do Azure AI Foundry
2. **Gerar Rascunho**: O agente Evangelist cria um rascunho de tutorial a partir de um esbo√ßo
3. **Revisar Conte√∫do**: O Content Reviewer avalia a qualidade do rascunho
4. **Encaminhamento Condicional**:
   - **Se aprovado (>200 palavras)**: O executor Publish salva como ficheiro Markdown
   - **Se rejeitado (<200 palavras)**: O executor SendReview envia notifica√ß√£o de revis√£o
5. **Exibir Resultados**: Mostrar o resultado final do fluxo de trabalho

### üîß Op√ß√µes de Personaliza√ß√£o

**Modificar Crit√©rios de Revis√£o:**
```csharp
const string ContentReviewerInstructions = @"
You are a content reviewer...
1. Check if content is more than 500 words (instead of 200)
2. Verify technical accuracy
3. Ensure proper formatting
...";
```

**Adicionar Mais Caminhos Condicionais:**
```csharp
var workflow = new WorkflowBuilder(draftExecutor)
    .AddEdge(draftExecutor, contentReviewerExecutor)
    .AddEdge(contentReviewerExecutor, publishExecutor, condition: GetCondition("Excellent"))
    .AddEdge(contentReviewerExecutor, editExecutor, condition: GetCondition("Good"))
    .AddEdge(contentReviewerExecutor, sendReviewerExecutor, condition: GetCondition("Poor"))
    .Build();
```

**Alterar Requisitos de Conte√∫do:**
```csharp
string OUTLINE_Content = @"
# Your Custom Topic
## Section 1
https://your-reference-url
## Section 2
...
";
```

### üéØ Aplica√ß√µes no Mundo Real

Este padr√£o de fluxo de trabalho condicional √© ideal para:
- **Sistemas de Gest√£o de Conte√∫do**: Fluxos editoriais automatizados com port√µes de qualidade
- **Processamento de Documentos**: Encaminhar documentos com base em classifica√ß√£o e conformidade
- **Suporte ao Cliente**: Encaminhamento inteligente de tickets com base em complexidade e urg√™ncia
- **Revis√£o Jur√≠dica**: Encaminhar contratos com base em avalia√ß√£o de risco e valor
- **Processos de RH**: Encaminhar candidaturas atrav√©s de fluxos de triagem apropriados

### üîç Compreendendo a L√≥gica Condicional

**Fun√ß√£o de Condi√ß√£o:**
```csharp
public Func<object?, bool> GetCondition(string expectedResult) =>
    reviewResult => reviewResult is ReviewResult review && review.Result == expectedResult;
```

Esta fun√ß√£o cria um predicado que:
1. Verifica se o resultado √© do tipo `ReviewResult`
2. Compara a propriedade `Result` com o valor esperado
3. Retorna verdadeiro/falso para determinar o encaminhamento

**Arestas do Fluxo de Trabalho com Condi√ß√µes:**
```csharp
.AddEdge(contentReviewerExecutor, publishExecutor, condition: GetCondition("Yes"))
.AddEdge(contentReviewerExecutor, sendReviewerExecutor, condition: GetCondition("No"))
```

### üìä Funcionalidades Avan√ßadas

**Valida√ß√£o de Esquema JSON:**
O fluxo de trabalho utiliza esquemas JSON para garantir respostas estruturadas:

```csharp
// Define response structure
public class ReviewResult
{
    [JsonPropertyName("review_result")]
    public string Result { get; set; } = string.Empty;
    
    [JsonPropertyName("reason")]
    public string Reason { get; set; } = string.Empty;
    
    [JsonPropertyName("draft_content")]
    public string DraftContent { get; set; } = string.Empty;
}

// Apply to agent
ResponseFormat = ChatResponseFormat.ForJsonSchema(
    AIJsonUtilities.CreateJsonSchema(typeof(ReviewResult)), 
    "ReviewResult", 
    "Review Result From DraftContent"
)
```

**Integra√ß√£o com Grounding do Bing:**
O agente Evangelist utiliza grounding do Bing para acessar informa√ß√µes em tempo real:

```csharp
var bingGroundingConfig = new BingGroundingSearchConfiguration(bing_conn_id);
BingGroundingToolDefinition bingGroundingTool = new(
    new BingGroundingSearchToolParameters([bingGroundingConfig])
);
```

Isso permite que o agente siga URLs no esbo√ßo e extraia informa√ß√µes atuais.

### üõ°Ô∏è Tratamento de Erros

O fluxo de trabalho inclui tratamento robusto de erros para conte√∫do rejeitado:
- Falhas na revis√£o acionam o caminho alternativo
- Notifica√ß√µes fornecem raz√µes claras para rejei√ß√£o
- O conte√∫do √© preservado para revis√£o

### üîÑ Expandindo o Fluxo de Trabalho

**Adicionar um Ciclo de Revis√£o:**
Criar um loop de feedback que reescreva automaticamente o conte√∫do:

```csharp
.AddEdge(contentReviewerExecutor, publishExecutor, condition: GetCondition("Yes"))
.AddEdge(contentReviewerExecutor, draftExecutor, condition: GetCondition("No")) // Loop back
```

**Implementar Revis√£o em M√∫ltiplos N√≠veis:**
Adicionar m√∫ltiplos est√°gios de revis√£o com crit√©rios diferentes:

```csharp
.AddEdge(draftExecutor, technicalReviewer)
.AddEdge(technicalReviewer, editorialReviewer, condition: GetCondition("TechPass"))
.AddEdge(editorialReviewer, publishExecutor, condition: GetCondition("EditPass"))
```

Este padr√£o de fluxo de trabalho condicional fornece a base para construir sistemas de automa√ß√£o empresarial sofisticados e inteligentes! üöÄ

---

<!-- CO-OP TRANSLATOR DISCLAIMER START -->
**Aviso Legal**:  
Este documento foi traduzido utilizando o servi√ßo de tradu√ß√£o por IA [Co-op Translator](https://github.com/Azure/co-op-translator). Embora nos esforcemos pela precis√£o, esteja ciente de que tradu√ß√µes autom√°ticas podem conter erros ou imprecis√µes. O documento original na sua l√≠ngua nativa deve ser considerado a fonte autorit√°ria. Para informa√ß√µes cr√≠ticas, recomenda-se uma tradu√ß√£o profissional realizada por humanos. N√£o nos responsabilizamos por quaisquer mal-entendidos ou interpreta√ß√µes incorretas decorrentes do uso desta tradu√ß√£o.
<!-- CO-OP TRANSLATOR DISCLAIMER END -->