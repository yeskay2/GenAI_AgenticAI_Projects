<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "b9c6e32c9b5f2fed20b6916984440d88",
  "translation_date": "2025-11-11T13:23:00+00:00",
  "source_file": "08-multi-agent/code_samples/workflows-agent-framework/dotNET/03.dotnet-agent-framework-workflow-ghmodel-concurrent.md",
  "language_code": "fi"
}
-->
# âš¡ Samanaikaiset agenttityÃ¶nkulut GitHub-mallien kanssa (.NET)

## ğŸ“‹ Korkean suorituskyvyn rinnakkaiskÃ¤sittelyn opas

TÃ¤mÃ¤ muistikirja esittelee **samanaikaisia tyÃ¶nkulkuja** Microsoft Agent Frameworkin ja GitHub-mallien avulla .NET-ympÃ¤ristÃ¶ssÃ¤. Opit rakentamaan korkean suorituskyvyn rinnakkaiskÃ¤sittelyn tyÃ¶nkulkuja, jotka maksimoivat lÃ¤pimenon suorittamalla useita tekoÃ¤lyagentteja samanaikaisesti sÃ¤ilyttÃ¤en samalla koordinoinnin ja tietojen johdonmukaisuuden.

## ğŸ¯ Oppimistavoitteet

### ğŸš€ **RinnakkaiskÃ¤sittelyn perusteet**
- **Agenttien rinnakkaissuoritus**: Suorita useita tekoÃ¤lyagentteja samanaikaisesti maksimaalisen suorituskyvyn saavuttamiseksi
- **Async/Await-mallit**: HyÃ¶dynnÃ¤ .NET:n asynkronista ohjelmointimallia tehokkaaseen rinnakkaiskÃ¤sittelyyn
- **GitHub-mallien integrointi**: Koordinoi useita samanaikaisia kutsuja GitHubin tekoÃ¤lymallien tulkintapalveluun
- **Resurssien hallinta**: Hallitse tekoÃ¤lymallien resursseja tehokkaasti samanaikaisten operaatioiden aikana

### ğŸ—ï¸ **Edistynyt rinnakkaisarkkitehtuuri**
- **TehtÃ¤vÃ¤pohjainen rinnakkaisuus**: KÃ¤ytÃ¤ .NET Task Parallel LibraryÃ¤ optimaaliseen rinnakkaissuoritukseen
- **Synkronointimallit**: Koordinoi samanaikaisia agentteja vÃ¤lttÃ¤en kilpailutilanteita
- **Kuormituksen tasapainotus**: Jaa tyÃ¶ tehokkaasti kÃ¤ytettÃ¤vissÃ¤ olevan rinnakkaiskapasiteetin kesken
- **Vikasietoisuus**: KÃ¤sittele yksittÃ¤isten agenttien epÃ¤onnistumiset pysÃ¤yttÃ¤mÃ¤ttÃ¤ koko tyÃ¶nkulkua

### ğŸ¢ **Yritystason samanaikaiset sovellukset**
- **Suuri mÃ¤Ã¤rÃ¤ dokumenttien kÃ¤sittelyÃ¤**: KÃ¤sittele useita dokumentteja samanaikaisesti
- **Reaaliaikainen sisÃ¤llÃ¶n analyysi**: Analysoi saapuvia datavirtoja samanaikaisesti
- **ErÃ¤kÃ¤sittelyn optimointi**: Maksimoi lÃ¤pimeno suurten datamÃ¤Ã¤rien kÃ¤sittelyssÃ¤
- **Monimuotoinen analyysi**: KÃ¤sittele rinnakkain eri sisÃ¤ltÃ¶tyyppejÃ¤ ja -formaatteja

## âš™ï¸ Esivaatimukset ja asennus

### ğŸ“¦ **Tarvittavat NuGet-paketit**

VÃ¤lttÃ¤mÃ¤ttÃ¶mÃ¤t paketit korkean suorituskyvyn rinnakkaiskÃ¤sittelyyn:

```xml
<!-- Core AI Framework with Async Support -->
<PackageReference Include="Microsoft.Extensions.AI" Version="9.9.0" />

<!-- Client Model Abstractions for API Communication -->
<PackageReference Include="System.ClientModel" Version="1.6.1.0" />

<!-- Azure Identity and Async LINQ for Advanced Operations -->
<PackageReference Include="Azure.Identity" Version="1.15.0" />
<PackageReference Include="System.Linq.Async" Version="6.0.3" />

<!-- Local Agent Framework References -->
<!-- Microsoft.Agents.AI.dll - Core agent abstractions with async support -->
<!-- Microsoft.Agents.AI.OpenAI.dll - GitHub Models integration with concurrency -->
```

### ğŸ”‘ **GitHub-mallien konfigurointi**

**YmpÃ¤ristÃ¶n asennus (.env-tiedosto):**
```env
GITHUB_TOKEN=your_github_personal_access_token
GITHUB_ENDPOINT=https://models.inference.ai.azure.com
GITHUB_MODEL_ID=gpt-4o-mini
```

**RinnakkaiskÃ¤sittelyn huomioitavat seikat:**
```csharp
// Configure for concurrent operations
var clientOptions = new OpenAIClientOptions()
{
    Endpoint = new Uri(githubEndpoint),
    // Configure connection pooling for concurrent requests
    NetworkTimeout = TimeSpan.FromMinutes(5)
};
```

### ğŸ—ï¸ **Rinnakkaisen tyÃ¶nkulun arkkitehtuuri**

```mermaid
graph TD
    A[Workflow Input] --> B[Task Distribution]
    B --> C[Concurrent Agent Pool]
    C --> D[Agent Task 1]
    C --> E[Agent Task 2]
    C --> F[Agent Task 3]
    C --> G[Agent Task N]
    
    D --> H[Result Aggregation]
    E --> H
    F --> H
    G --> H
    
    H --> I[Synchronized Output]
    
    J[GitHub Models API] --> D
    J --> E
    J --> F
    J --> G
    
    K[.NET Task Scheduler] --> C
```

**Keskeiset komponentit:**
- **Task Parallel Library**: .NET:n sisÃ¤Ã¤nrakennettu tuki rinnakkaisille operaatioille
- **Agent Pool**: Useita agentti-instansseja rinnakkaiskÃ¤sittelyyn
- **Tulosten yhdistÃ¤minen**: Koordinoi ja yhdistÃ¤ samanaikaisten agenttien tulokset
- **Synkronointipisteet**: Varmista tietojen johdonmukaisuus samanaikaisten operaatioiden vÃ¤lillÃ¤

## ğŸ¨ **Rinnakkaisen tyÃ¶nkulun suunnittelumallit**

### ğŸ” **Rinnakkainen tutkimus ja analyysi**
```
Research Topic â†’ Concurrent Research Agents â†’ Result Synthesis â†’ Final Report
```

### ğŸ“Š **MonilÃ¤hteinen datankÃ¤sittely**
```
Data Sources â†’ Parallel Processing Agents â†’ Data Integration â†’ Unified Output
```

### ğŸ­ **SisÃ¤llÃ¶ntuotantoputki**
```
Content Requirements â†’ Concurrent Content Generators â†’ Quality Review â†’ Final Content
```

### ğŸ”„ **Fan-Out/Fan-In-kÃ¤sittely**
```
Single Input â†’ Multiple Concurrent Processors â†’ Result Aggregation â†’ Single Output
```

## ğŸ¢ **Yritystason suorituskyvyn edut**

### âš¡ **LÃ¤pimenon ja skaalautuvuuden parantaminen**
- **Lineaarinen suorituskyvyn skaalaus**: LisÃ¤Ã¤ samanaikaisia agentteja lÃ¤pimenon kasvattamiseksi
- **Resurssien hyÃ¶dyntÃ¤minen**: Maksimoi kÃ¤ytettÃ¤vissÃ¤ olevan tekoÃ¤lymallikapasiteetin tehokkuus
- **Lyhennetty kÃ¤sittelyaika**: MerkittÃ¤vÃ¤ ajansÃ¤Ã¤stÃ¶ rinnakkaissuorituksen avulla
- **Joustava skaalaus**: SÃ¤Ã¤dÃ¤ samanaikaisten agenttien mÃ¤Ã¤rÃ¤Ã¤ dynaamisesti tyÃ¶kuorman mukaan

### ğŸ›¡ï¸ **Luotettavuus ja kestÃ¤vyys**
- **Vikojen eristÃ¤minen**: YksittÃ¤isten agenttien epÃ¤onnistumiset eivÃ¤t vaikuta muihin samanaikaisiin operaatioihin
- **Hallittu heikentyminen**: JÃ¤rjestelmÃ¤ jatkaa toimintaansa pienemmÃ¤llÃ¤ agenttikapasiteetilla
- **Virheiden korjaus**: Automaattiset uudelleenkÃ¤ynnistysmekanismit epÃ¤onnistuneille operaatioille
- **Kuormituksen jakaminen**: TyÃ¶n tasainen jakaminen kÃ¤ytettÃ¤vissÃ¤ olevien agenttien kesken

### ğŸ“Š **Suorituskyvyn seuranta**
- **Samanaikaisten operaatioiden mittarit**: Seuraa kaikkien rinnakkaisten operaatioiden suorituskykyÃ¤
- **Resurssien kÃ¤yttÃ¶analytiikka**: Tarkkaile CPU:n, muistin ja verkon kÃ¤yttÃ¶Ã¤
- **LÃ¤pimenon analyysi**: Mittaa tehokkuuden parannuksia rinnakkaiskÃ¤sittelystÃ¤
- **Pullonkaulojen tunnistus**: Tunnista ja ratkaise suorituskyvyn rajoitteet

### ğŸ”§ **Kehitys ja operointi**
- **Async-ohjelmointimalli**: HyÃ¶dynnÃ¤ .NET:n kehittyneitÃ¤ async/await-malleja
- **TehtÃ¤vien koordinointi**: SisÃ¤Ã¤nrakennetut tehtÃ¤vien hallinta- ja koordinointiominaisuudet
- **Poikkeusten kÃ¤sittely**: Kattava virheenkÃ¤sittely samanaikaisille operaatioille
- **Debuggaustuki**: Visual Studion debuggaustyÃ¶kalut rinnakkaisille tyÃ¶nkuluille

Rakennetaan korkean suorituskyvyn samanaikaisia tekoÃ¤lytyÃ¶nkulkuja .NET:llÃ¤! ğŸš€

## ğŸ’» Koodin suorittaminen

TÃ¤ydellinen toteutus lÃ¶ytyy tiedostosta `03.dotnet-agent-framework-workflow-ghmodel-concurrent.cs`. TÃ¤mÃ¤ tiedosto esittelee **Fan-Out/Fan-In-rinnakkaistyÃ¶nkulun** matkasuunnitteluun:

### ğŸ—ï¸ **TyÃ¶nkulun arkkitehtuuri**

```
User Request â†’ ConcurrentStartExecutor â†’ [Researcher Agent || Planner Agent] â†’ ConcurrentAggregationExecutor â†’ Final Output
```

**Keskeiset komponentit:**

1. **ConcurrentStartExecutor**: LÃ¤hettÃ¤Ã¤ kÃ¤yttÃ¤jÃ¤n pyynnÃ¶n kaikille agenteille samanaikaisesti
2. **Researcher Agent**: Analysoi kohteita ja nÃ¤htÃ¤vyyksiÃ¤ rinnakkain
3. **Planner Agent**: Laatii yksityiskohtaisia matkasuunnitelmia rinnakkain
4. **ConcurrentAggregationExecutor**: KerÃ¤Ã¤ ja yhdistÃ¤Ã¤ molempien agenttien tulokset

### ğŸ¯ **Fan-Out/Fan-In-malli**

TÃ¤mÃ¤ tyÃ¶nkulku esittelee klassisen **Fan-Out/Fan-In**-mallin:
- **Fan-Out**: Yksi syÃ¶teviesti lÃ¤hetetÃ¤Ã¤n samanaikaisesti useille agenteille
- **RinnakkaiskÃ¤sittely**: Useat agentit tyÃ¶skentelevÃ¤t rinnakkain saman tehtÃ¤vÃ¤n parissa
- **Fan-In**: Kaikkien agenttien tulokset kerÃ¤tÃ¤Ã¤n ja yhdistetÃ¤Ã¤n yhdeksi ulostuloksi

### ğŸš€ Esimerkin suorittaminen

```bash
# Make the script executable (Unix/Linux/macOS)
chmod +x 03.dotnet-agent-framework-workflow-ghmodel-concurrent.cs

# Run the concurrent workflow
./03.dotnet-agent-framework-workflow-ghmodel-concurrent.cs
```

Tai Windowsissa:
```powershell
dotnet run 03.dotnet-agent-framework-workflow-ghmodel-concurrent.cs
```

### ğŸ“ Odotettu tulos

TyÃ¶nkulku:
1. **LÃ¤hettÃ¤Ã¤ pyynnÃ¶n**: LÃ¤hettÃ¤Ã¤ "Suunnittele matka Seattleen joulukuussa" molemmille agenteille
2. **RinnakkaiskÃ¤sittely**: Molemmat agentit tyÃ¶skentelevÃ¤t samanaikaisesti:
   - Tutkija tunnistaa nÃ¤htÃ¤vyydet ja yksityiskohdat
   - Suunnittelija laatii aikataulun ja logistiikan
3. **YhdistÃ¤minen**: YhdistÃ¤Ã¤ molempien vastaukset kattavaksi ulostuloksi
4. **NÃ¤yttÃ¤Ã¤ tulokset**: NÃ¤yttÃ¤Ã¤ yhdistetyn matkasuunnitelman kaikilla tiedoilla

### ğŸ”§ Muokkausvaihtoehdot

**LisÃ¤Ã¤ samanaikaisia agentteja:**
```csharp
// Create additional specialized agents
AIAgent budgetAgent = openAIClient.GetChatClient(github_model_id).CreateAIAgent(
    name: "Budget-Agent", instructions: "Calculate travel costs...");

// Add to fan-out
var workflow = new WorkflowBuilder(startExecutor)
    .AddFanOutEdge(startExecutor, targets: [researcherAgent, plannerAgent, budgetAgent])
    .AddFanInEdge(aggregationExecutor, sources: [researcherAgent, plannerAgent, budgetAgent])
    .WithOutputFrom(aggregationExecutor)
    .Build();

// Update aggregation count
if (this._messages.Count == 3) { ... }
```

**Muokkaa agenttien ohjeita:**
```csharp
const string ResearcherAgentInstructions = "Your custom instructions for research...";
const string PlanAgentInstructions = "Your custom instructions for planning...";
```

**Muuta tehtÃ¤vÃ¤Ã¤:**
```csharp
StreamingRun run = await InProcessExecution.StreamAsync(
    workflow, 
    "Plan a European vacation for 2 weeks in summer"
);
```

### ğŸ¯ Todelliset sovellukset

TÃ¤mÃ¤ rinnakkainen malli sopii erinomaisesti:
- **SisÃ¤llÃ¶ntuotanto**: Useat kirjoittajat luovat eri osioita samanaikaisesti
- **Koodin tarkistus**: Useat tarkistajat analysoivat koodia eri nÃ¤kÃ¶kulmista
- **Markkinatutkimus**: Rinnakkainen analyysi eri markkinasegmenteistÃ¤
- **Dokumenttien kÃ¤sittely**: Rinnakkainen tiedon poiminta, analyysi ja validointi
- **MoninÃ¤kÃ¶kulmainen analyysi**: Erilaisten nÃ¤kÃ¶kulmien saaminen samaan syÃ¶tteeseen

### ğŸ” YmmÃ¤rrÃ¤ mukautetut suorittajat

**ConcurrentStartExecutor:**
- Toteuttaa `IMessageHandler<string>` vastaanottaakseen merkkijonosyÃ¶tteen
- LÃ¤hettÃ¤Ã¤ viestit kaikille liitetyille agenteille
- LÃ¤hettÃ¤Ã¤ `TurnToken` kÃ¤ynnistÃ¤Ã¤kseen rinnakkaiskÃ¤sittelyn

**ConcurrentAggregationExecutor:**
- Toteuttaa `IMessageHandler<ChatMessage>` vastaanottaakseen agenttien vastaukset
- KerÃ¤Ã¤ viestit sÃ¤ikeiden turvallisella tavalla
- YhdistÃ¤Ã¤ tulokset, kun kaikki odotetut vastaukset ovat saapuneet
- Tuottaa lopullisen ulostulon kÃ¤yttÃ¤en `context.YieldOutputAsync()`

### âš¡ Suorituskyvyn edut

**Rinnakkainen vs. perÃ¤kkÃ¤inen:**
- PerÃ¤kkÃ¤inen: Agentti1 (30s) â†’ Agentti2 (30s) = **60 sekuntia yhteensÃ¤**
- Rinnakkainen: Agentti1 (30s) || Agentti2 (30s) = **30 sekuntia yhteensÃ¤**

**LÃ¤pimenon parannus**: Jopa NÃ— nopeampi N samanaikaisella agentilla (riippuen tyÃ¶kuormasta ja resursseista)

### ğŸ›¡ï¸ VirheenkÃ¤sittely

TyÃ¶nkulku kÃ¤sittelee yksittÃ¤isten agenttien epÃ¤onnistumiset hallitusti:
- Jos yksi agentti epÃ¤onnistuu, muut jatkavat kÃ¤sittelyÃ¤
- YhdistÃ¤jÃ¤ voi toteuttaa aikakatkaisulogiikan
- Osittaiset tulokset voidaan palauttaa tarvittaessa

### ğŸ“Š Edistyneet ominaisuudet

**Dynaaminen agenttimÃ¤Ã¤rÃ¤:**
Muokkaa yhdistÃ¤mislogiikkaa tukemaan vaihtelevaa agenttimÃ¤Ã¤rÃ¤Ã¤:

```csharp
private int _expectedAgentCount;
private readonly List<ChatMessage> _messages = [];

public async ValueTask HandleAsync(ChatMessage message, IWorkflowContext context)
{
    this._messages.Add(message);
    if (this._messages.Count == _expectedAgentCount)
    {
        // Process aggregation
    }
}
```

TÃ¤mÃ¤ rinnakkainen tyÃ¶nkulku on olennainen korkean suorituskyvyn, skaalautuvien tekoÃ¤lyagenttijÃ¤rjestelmien rakentamisessa!

---

<!-- CO-OP TRANSLATOR DISCLAIMER START -->
**Vastuuvapauslauseke**:  
TÃ¤mÃ¤ asiakirja on kÃ¤Ã¤nnetty kÃ¤yttÃ¤mÃ¤llÃ¤ tekoÃ¤lypohjaista kÃ¤Ã¤nnÃ¶spalvelua [Co-op Translator](https://github.com/Azure/co-op-translator). Vaikka pyrimme tarkkuuteen, huomioithan, ettÃ¤ automaattiset kÃ¤Ã¤nnÃ¶kset voivat sisÃ¤ltÃ¤Ã¤ virheitÃ¤ tai epÃ¤tarkkuuksia. AlkuperÃ¤istÃ¤ asiakirjaa sen alkuperÃ¤isellÃ¤ kielellÃ¤ tulisi pitÃ¤Ã¤ ensisijaisena lÃ¤hteenÃ¤. Kriittisen tiedon osalta suositellaan ammattimaista ihmiskÃ¤Ã¤nnÃ¶stÃ¤. Emme ole vastuussa vÃ¤Ã¤rinkÃ¤sityksistÃ¤ tai virhetulkinnoista, jotka johtuvat tÃ¤mÃ¤n kÃ¤Ã¤nnÃ¶ksen kÃ¤ytÃ¶stÃ¤.
<!-- CO-OP TRANSLATOR DISCLAIMER END -->